<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>PISA – MASTEMR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-408f44cb79879323703c9e228b025f96.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../css/mastemr.css">
</head>
<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/KCL_logo.png" alt="" class="navbar-logo light-content"><img src="../images/KCL_logo.png" alt="" class="navbar-logo dark-content"></a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">MASTEMR</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/A1-PISA_analysis.html">Appendicies</a></li><li class="breadcrumb-item"><a href="../chapters/A1-PISA_analysis.html">PISA</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Sessions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-Intro_to_quant_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01 Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">02 Introduction to R</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-1-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-2-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loading packages and exploring data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-3-Intro_to_analysis_software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Piping and dplyr</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-4-Intro_to_graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Making graphs</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-Descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 Descriptive Statistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-Introduction_to_PISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 Introduction to PISA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-Presentations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 Presentations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-T-testsPISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06 T-tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-ChisqPISA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07 Hypothesis testing and Chi-square tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-Assignment_3_tutorials.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08 Assignment 3 tutorials</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-Correlation_and_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09 Correlation and regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-selecting_statistical_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10 Selecting statistical tools</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Additional tests</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A8-SEM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SEM</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendicies</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A1-PISA_analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">PISA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A2-DfE_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DfE England</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A3-TIMSS_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TIMSS, PIRLS and ICILS</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A4-Other_datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A5-Self_Study_Tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Self Study Tasks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A6-QandA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Questions and Answers</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#what-is-pisa" id="toc-what-is-pisa" class="nav-link active" data-scroll-target="#what-is-pisa"><span class="header-section-number">1</span> What is PISA</a></li>
  <li>
<a href="#how-to-use-it" id="toc-how-to-use-it" class="nav-link" data-scroll-target="#how-to-use-it"><span class="header-section-number">2</span> How to use it</a>
  <ul class="collapse">
<li><a href="#cleaning-code" id="toc-cleaning-code" class="nav-link" data-scroll-target="#cleaning-code"><span class="header-section-number">2.1</span> Cleaning code</a></li>
  </ul>
</li>
  <li><a href="#common-issues" id="toc-common-issues" class="nav-link" data-scroll-target="#common-issues"><span class="header-section-number">3</span> Common issues</a></li>
  <li>
<a href="#publishing-your-pisa-analysis" id="toc-publishing-your-pisa-analysis" class="nav-link" data-scroll-target="#publishing-your-pisa-analysis"><span class="header-section-number">4</span> Publishing your PISA analysis</a>
  <ul class="collapse">
<li><a href="#sec-PV" id="toc-sec-PV" class="nav-link" data-scroll-target="#sec-PV"><span class="header-section-number">4.1</span> Plausible Values</a></li>
  <li>
<a href="#what-are-weights" id="toc-what-are-weights" class="nav-link" data-scroll-target="#what-are-weights"><span class="header-section-number">4.2</span> What are weights</a>
  <ul class="collapse">
<li><a href="#student-weights" id="toc-student-weights" class="nav-link" data-scroll-target="#student-weights"><span class="header-section-number">4.2.1</span> Student weights</a></li>
  <li><a href="#senate-weights" id="toc-senate-weights" class="nav-link" data-scroll-target="#senate-weights"><span class="header-section-number">4.2.2</span> Senate weights</a></li>
  </ul>
</li>
  <li><a href="#how-do-i-use-the-plausible-values-and-weights-correctly" id="toc-how-do-i-use-the-plausible-values-and-weights-correctly" class="nav-link" data-scroll-target="#how-do-i-use-the-plausible-values-and-weights-correctly"><span class="header-section-number">4.3</span> How do I use the plausible values and weights correctly?</a></li>
  </ul>
</li>
  <li>
<a href="#questions" id="toc-questions" class="nav-link" data-scroll-target="#questions"><span class="header-section-number">5</span> Questions</a>
  <ul class="collapse">
<li><a href="#where-can-i-find-examples-of-pisa-test-items" id="toc-where-can-i-find-examples-of-pisa-test-items" class="nav-link" data-scroll-target="#where-can-i-find-examples-of-pisa-test-items"><span class="header-section-number">5.1</span> Where can I find examples of PISA test items?</a></li>
  <li><a href="#why-are-some-countries-oecd-countries-and-others-arent" id="toc-why-are-some-countries-oecd-countries-and-others-arent" class="nav-link" data-scroll-target="#why-are-some-countries-oecd-countries-and-others-arent"><span class="header-section-number">5.2</span> Why are some countries OECD countries and others aren’t?</a></li>
  <li><a href="#why-are-the-pv-grades-pivoting-around-the-500-mark" id="toc-why-are-the-pv-grades-pivoting-around-the-500-mark" class="nav-link" data-scroll-target="#why-are-the-pv-grades-pivoting-around-the-500-mark"><span class="header-section-number">5.3</span> Why are the PV grades pivoting around the ~500 mark?</a></li>
  <li><a href="#but-the-mean-pv-score-isnt-500" id="toc-but-the-mean-pv-score-isnt-500" class="nav-link" data-scroll-target="#but-the-mean-pv-score-isnt-500"><span class="header-section-number">5.4</span> But the mean PV score isn’t 500?!</a></li>
  <li><a href="#why-are-the-letters-ta-and-na-used-in-some-field-names" id="toc-why-are-the-letters-ta-and-na-used-in-some-field-names" class="nav-link" data-scroll-target="#why-are-the-letters-ta-and-na-used-in-some-field-names"><span class="header-section-number">5.5</span> Why are the letters TA and NA used in some field names?</a></li>
  <li><a href="#how-do-i-find-fields-that-are-numeric" id="toc-how-do-i-find-fields-that-are-numeric" class="nav-link" data-scroll-target="#how-do-i-find-fields-that-are-numeric"><span class="header-section-number">5.6</span> How do I find fields that are numeric?</a></li>
  <li><a href="#how-are-schools-and-students-selected-to-take-part-in-pisa" id="toc-how-are-schools-and-students-selected-to-take-part-in-pisa" class="nav-link" data-scroll-target="#how-are-schools-and-students-selected-to-take-part-in-pisa"><span class="header-section-number">5.7</span> How are schools and students selected to take part in PISA?</a></li>
  <li><a href="#what-are-the-pisa-test-questions-like" id="toc-what-are-the-pisa-test-questions-like" class="nav-link" data-scroll-target="#what-are-the-pisa-test-questions-like"><span class="header-section-number">5.8</span> What are the PISA test questions like?</a></li>
  <li><a href="#how-can-i-find-the-ethnicity-or-race-of-a-student-taking-the-pisa-test" id="toc-how-can-i-find-the-ethnicity-or-race-of-a-student-taking-the-pisa-test" class="nav-link" data-scroll-target="#how-can-i-find-the-ethnicity-or-race-of-a-student-taking-the-pisa-test"><span class="header-section-number">5.9</span> How can I find the ethnicity or race of a student taking the PISA test?</a></li>
  <li><a href="#what-are-the-pisa-domains" id="toc-what-are-the-pisa-domains" class="nav-link" data-scroll-target="#what-are-the-pisa-domains"><span class="header-section-number">5.10</span> What are the PISA domains?</a></li>
  <li><a href="#why-is-china-given-the-cnt-value-b-s-j-z-china-2018-or-b-s-j-g-china-2015" id="toc-why-is-china-given-the-cnt-value-b-s-j-z-china-2018-or-b-s-j-g-china-2015" class="nav-link" data-scroll-target="#why-is-china-given-the-cnt-value-b-s-j-z-china-2018-or-b-s-j-g-china-2015"><span class="header-section-number">5.11</span> Why is China given the <code>CNT</code> value <code>B-S-J-Z (China)</code> (2018) or <code>B-S-J-G (China)</code> (2015)?</a></li>
  <li><a href="#where-is-mainland-china-in-pisa-2022" id="toc-where-is-mainland-china-in-pisa-2022" class="nav-link" data-scroll-target="#where-is-mainland-china-in-pisa-2022"><span class="header-section-number">5.12</span> Where is mainland China in PISA 2022?</a></li>
  <li><a href="#how-do-i-calculate-weighted-means-of-the-pv-scores" id="toc-how-do-i-calculate-weighted-means-of-the-pv-scores" class="nav-link" data-scroll-target="#how-do-i-calculate-weighted-means-of-the-pv-scores"><span class="header-section-number">5.13</span> How do I calculate weighted means of the PV scores?</a></li>
  </ul>
</li>
  <li>
<a href="#pisa-quirks" id="toc-pisa-quirks" class="nav-link" data-scroll-target="#pisa-quirks"><span class="header-section-number">6</span> PISA quirks</a>
  <ul class="collapse">
<li><a href="#empty-fields" id="toc-empty-fields" class="nav-link" data-scroll-target="#empty-fields"><span class="header-section-number">6.1</span> Empty fields</a></li>
  <li><a href="#cyprus-present-but-missing" id="toc-cyprus-present-but-missing" class="nav-link" data-scroll-target="#cyprus-present-but-missing"><span class="header-section-number">6.2</span> Cyprus present but missing</a></li>
  <li><a href="#great-britain-vs-the-united-kingdom" id="toc-great-britain-vs-the-united-kingdom" class="nav-link" data-scroll-target="#great-britain-vs-the-united-kingdom"><span class="header-section-number">6.3</span> Great Britain vs the United Kingdom</a></li>
  <li><a href="#how-to-spell-ukrainian" id="toc-how-to-spell-ukrainian" class="nav-link" data-scroll-target="#how-to-spell-ukrainian"><span class="header-section-number">6.4</span> How to spell “Ukrainian”</a></li>
  </ul>
</li>
  <li><a href="#interesting-papers-and-reading-on-pisa" id="toc-interesting-papers-and-reading-on-pisa" class="nav-link" data-scroll-target="#interesting-papers-and-reading-on-pisa"><span class="header-section-number">7</span> Interesting papers and reading on PISA</a></li>
  <li><a href="#copyright" id="toc-copyright" class="nav-link" data-scroll-target="#copyright"><span class="header-section-number">8</span> Copyright</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/A1-PISA_analysis.html">Appendicies</a></li><li class="breadcrumb-item"><a href="../chapters/A1-PISA_analysis.html">PISA</a></li></ol></nav><div class="quarto-title">
<h1 class="title">PISA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="what-is-pisa" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> What is PISA</h1>
<p>The <em>Programme for International Student Assessment</em> (PISA) is an OECD initiative that looks at the reading, mathematics and science abilities of students aged 15 years old. Data is collected from ~38 OECD countries and other partner countries every three years.</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Dataset</th>
<th>Description</th>
<th style="text-align: center;">03</th>
<th style="text-align: center;">06</th>
<th style="text-align: center;">09</th>
<th style="text-align: center;">12</th>
<th style="text-align: center;">15</th>
<th style="text-align: center;">18</th>
<th style="text-align: center;">22</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Student</td>
<td>demographic data on student participants</td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EX6zg63qlJpEgZ8uQhjxJ30BkXxo3MhtDnnxcdXV6d_9GA?e=ZjDjLE" title="PISA 2003 student parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EZrlaEKCQtZLpC8_pZZFQeQBoh8lOI3_KvTd931QY4CzuQ?e=zOzhDU" title="PISA 2006 student parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EWvwfbrA9z1Fu9uGQXBIGmwBoMDZQglAh4pHID_i3DB-GQ?e=mFDJW5" title="PISA 2009 student parquet file">x</a></td>
<td style="text-align: center;">
<a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/Ed6fJmhhfdNLomH5evre2DsBOStpg5KjkjtZKgflRX-J3g?e=qfgp7X" title="PISA 2012 student parquet file">x</a><!--old link https://drive.google.com/file/d/1-41Ynn4hzEL1vO2L-wIqdRotXDtDdjYh/view?usp=share_link)-->
</td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/Eb9NSm5rzm1OhtKiX6ZlPZwBm86Cd82ZAUohbzbozlkk4A?e=xofvn5" title="PISA 2015 student parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EZsx7bC_8jlDpsLrODivNpIBrFdwhJRezNYosyhoCyPjMA?e=7od1Dm" title="PISA 2018 student parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/r/personal/k1926273_kcl_ac_uk/Documents/Code/QERKCL_PISA/data/pisa/2022/PISA_student_2022.parquet?csf=1&amp;web=1&amp;e=jppggv" title="PISA 2022 student parquet file">x</a></td>
</tr>
<tr class="even">
<td>School</td>
<td>descriptive data about schools</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EcqBboQfdChEv4AWCosNfSkBHD_477xotsXmioba4OMixg?e=f9OFKz" title="PISA 2015 school parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EcqBboQfdChEv4AWCosNfSkBHD_477xotsXmioba4OMixg?e=PeIwqX" title="PISA 2015 school parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EZ6gBqzavF5Dr3bHGL8jPBkB0AzqtCvflBFRRfrNrIFLEg?e=8alaVy" title="PISA 2018 school parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EaEQPEKYzR9MmiqLBYXOhmYBNXYg15UoDKGip-78kS1DvA?e=q74fyK" title="PISA 2022 school parquet file">x</a></td>
</tr>
<tr class="odd">
<td>Parent</td>
<td>a survey for student’s parents including information about home environments and parental education</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td>Teacher</td>
<td>demographic, teaching, qualification and training data</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/ERlZD45RXhRBoOoR1B3EVNMBhCiAoB5Hd8LsgUlwHzlEdA?e=yyJfW7" title="PISA 2015 teacher parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EdVdIhwprLRGgN-o9u4DDH0BoIcgGEy84ERCKX4z-I3zaw?e=t3ceLR" title="PISA 2018 teacher parquet file">x</a></td>
<td style="text-align: center;"><a href="https://emckclac-my.sharepoint.com/:u:/g/personal/k1926273_kcl_ac_uk/EbFmgVVbQD9DlIIgOKHDhLcB8bA8lfQMDVSEkcjtByM2cQ?e=zYG4Is" title="PISA 2022 teacher parquet file">x</a></td>
</tr>
<tr class="odd">
<td>Cognitive</td>
<td>individual results for each exam style question students took</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;">x</td>
<td style="text-align: center;"><a href="https://drive.google.com/file/d/19GLw1-YA1aJGWoCWXfZGtUWnQi4pcjik/view?usp=share_link">x</a></td>
<td style="text-align: center;"><a href="https://drive.google.com/file/d/1sTpe3TJSnByhZdxzezkmXjH2uTH9TOUP/view?usp=share_link">x</a></td>
<td style="text-align: center;"><a href="https://drive.google.com/file/d/1nhwySp0A-LHfN-oO8HES9PQOIDZNmOzT/view?usp=share_link">x</a></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>PISA datasets above can be found on the <a href="https://www.oecd.org/pisa/data/">OECD website</a>. The links in the table above will allow you to download <code>.parquet</code> versions of these files which we have created, though they might need additional editing, e.g.&nbsp;reducing the number of columns or changing the types of each column. If you want to find out more about what each field stores, take a look at the corresponding codebook: <a href="https://webfs.oecd.org/pisa2022/CY08MSP_CODEBOOK_5thDecember23.xlsx">2022</a>, <a href="https://webfs.oecd.org/pisa2018/PISA2018_CODEBOOK.xlsx">2018</a>, <a href="https://webfs.oecd.org/pisa/Codebook_CMB.xlsx">2015</a>.</p>
</section><section id="how-to-use-it" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> How to use it</h1>
<p>The PISA datasets come in <em>SPSS</em> or <em>SAS</em> formats. The data used in this course comes directly from downloading the SPSS <code>.sav</code> files and using the <code>haven</code> package to clean it into a native R format suitable for analysis, in most cases <code>.parquet</code> files (see: <strong>?@sec-parquet</strong>). There are a few quirks that you need to be aware of:</p>
<ul>
<li>R uses levels (factors) instead of labelled data</li>
<li>All SPSS fields are <em>labelled</em>, and auto conversion into the native R data frame format would make numeric fields, factors(!?). To avoid this confusion we have stripped out the no-response data for numeric fields and replaced it with <code>NA</code> values. This means that you won’t be able to tell the reason that a field is missing, but most of the original data doesn’t appear to use the majority of these levels, i.e.&nbsp;there are few reasons given for missing data. The following labels have all been set to <code>NA</code>:</li>
</ul>
<table class="caption-top table">
<caption>Labels set to <code>NA</code> in <code>.parquet</code> files</caption>
<thead><tr class="header">
<th>value</th>
<th>label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>95</td>
<td>Valid Skip</td>
</tr>
<tr class="even">
<td>97</td>
<td>Not Applicable</td>
</tr>
<tr class="odd">
<td>98</td>
<td>Invalid</td>
</tr>
<tr class="even">
<td>99</td>
<td>No Response</td>
</tr>
</tbody>
</table>
<ul>
<li>As the fields are now using R’s native factor format you might find that the data doesn’t quite match the format of the table labels. For example, <code>CNT</code> is labelled “Country code 3-character”, but the data is now instead the full country name.</li>
<li>the examples shown in the book use cut down PISA data sets, where only a limited number of columns are included. The <em>full</em> datasets are linked in the table above.</li>
</ul>
<section id="cleaning-code" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="cleaning-code">
<span class="header-section-number">2.1</span> Cleaning code</h2>
<p>The <code>.parquet</code> files used in this book were produced using the following code.</p>
<p>First download the SPSS versions of the files from the <a href="https://www.oecd.org/pisa/data/">OECD website</a>, i.e.&nbsp;the <code>.sav</code> files.</p>
<p>Next create a function that converts <code>.sav</code> file columns to factors, picking up on a lot of edge cases:</p>
<div class="cell">
<details class="code-fold"><summary>PISA_factorise() function</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># take an SPSS PISA dataframe and convert it to R factors</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>PISA_factorise <span class="ot">&lt;-</span> <span class="cf">function</span>(df){</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="co"># </span><span class="al">TODO</span><span class="co">: use SPSS types to make this more efficient</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="co"># attr(df$x,"format.spss")</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  </span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="co"># PISA data has almost everything labelled!</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="co"># but not quite everything</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  lbls <span class="ot">&lt;-</span> <span class="fu">map</span>(df, <span class="cf">function</span>(x){</span>
<span id="cb1-10"><a href="#cb1-10"></a>    <span class="fu">attr</span>(x, <span class="st">"label"</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>  })</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>  <span class="co"># label names for dud data</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>  dodgy_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">99995</span>, <span class="dv">99997</span>, <span class="dv">99998</span>, <span class="dv">99999</span>,</span>
<span id="cb1-15"><a href="#cb1-15"></a>                    <span class="dv">99999995</span>, <span class="dv">99999997</span>, <span class="dv">99999998</span>, <span class="dv">99999999</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>                    <span class="dv">995</span>, <span class="dv">997</span>, <span class="dv">998</span>, <span class="dv">999</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a>  dodgy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Valid Skip"</span>, <span class="st">"Not Applicable"</span>, <span class="st">"Invalid"</span>, <span class="st">"No Response"</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a>  dodgy2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"Invalid"</span>, <span class="st">"Missing"</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a>  </span>
<span id="cb1-20"><a href="#cb1-20"></a>  dfc <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="co"># head(100) %&gt;% #select(any_of(c("ST04Q01", "SCHOOLID", "TC002Q01NA"))) %&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), </span>
<span id="cb1-22"><a href="#cb1-22"></a>                  <span class="cf">function</span>(x){</span>
<span id="cb1-23"><a href="#cb1-23"></a>                    x_lbls <span class="ot">&lt;-</span> <span class="fu">attr</span>(x, <span class="st">"labels"</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>                    x_lbl <span class="ot">&lt;-</span> <span class="fu">attr</span>(x, <span class="st">"label"</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>                    </span>
<span id="cb1-26"><a href="#cb1-26"></a>                    <span class="co"># outputs the current column name</span></span>
<span id="cb1-27"><a href="#cb1-27"></a>                    <span class="fu">message</span>(<span class="fu">cur_column</span>())</span>
<span id="cb1-28"><a href="#cb1-28"></a></span>
<span id="cb1-29"><a href="#cb1-29"></a>                    <span class="co"># if it doesn't have labels to start with e.g. CNTSCHID</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>                    <span class="co"># do a direct copy</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>                    <span class="cf">if</span>(<span class="fu">is.null</span>(x_lbls)){</span>
<span id="cb1-32"><a href="#cb1-32"></a>                      tmp <span class="ot">&lt;-</span> x</span>
<span id="cb1-33"><a href="#cb1-33"></a>                    }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">cur_column</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ST03Q02"</span>, <span class="st">"ST03Q01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb1-34"><a href="#cb1-34"></a>                             <span class="st">"character"</span> <span class="sc">%in%</span> <span class="fu">class</span>(x) <span class="sc">&amp;</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>                             <span class="fu">grepl</span>(<span class="st">"Month"</span>, x_lbl)){</span>
<span id="cb1-36"><a href="#cb1-36"></a>                      <span class="co"># for 2006/12 when date is a character?!</span></span>
<span id="cb1-37"><a href="#cb1-37"></a>                        <span class="fu">message</span>(<span class="st">"2006/12 - converting Month of birth character date to numeric"</span>)</span>
<span id="cb1-38"><a href="#cb1-38"></a>                        tmp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">d+$"</span>, x), x, <span class="cn">NA</span>))</span>
<span id="cb1-39"><a href="#cb1-39"></a>                        tmp[<span class="fu">as.numeric</span>(tmp) <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>                        tmp <span class="ot">&lt;-</span> month.name[tmp]</span>
<span id="cb1-41"><a href="#cb1-41"></a>                        tmp <span class="ot">&lt;-</span> <span class="fu">factor</span>(tmp, <span class="at">levels=</span><span class="fu">c</span>(</span>
<span id="cb1-42"><a href="#cb1-42"></a>                          <span class="st">"January"</span>, <span class="st">"February"</span>, <span class="st">"March"</span>, <span class="st">"April"</span>,</span>
<span id="cb1-43"><a href="#cb1-43"></a>                          <span class="st">"May"</span>, <span class="st">"June"</span>, <span class="st">"July"</span>, <span class="st">"August"</span>,</span>
<span id="cb1-44"><a href="#cb1-44"></a>                          <span class="st">"September"</span>, <span class="st">"October"</span>, <span class="st">"November"</span>, <span class="st">"December"</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>                        ))</span>
<span id="cb1-46"><a href="#cb1-46"></a>                    }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">cur_column</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"ST03Q03"</span>, <span class="st">"ST03Q02"</span>) <span class="sc">&amp;</span> </span>
<span id="cb1-47"><a href="#cb1-47"></a>                             <span class="st">"character"</span> <span class="sc">%in%</span> <span class="fu">class</span>(x) <span class="sc">&amp;</span></span>
<span id="cb1-48"><a href="#cb1-48"></a>                             <span class="fu">grepl</span>(<span class="st">"Year"</span>, x_lbl)){</span>
<span id="cb1-49"><a href="#cb1-49"></a>                      <span class="co"># for 2006/12 when date is a character?!</span></span>
<span id="cb1-50"><a href="#cb1-50"></a>                      <span class="fu">message</span>(<span class="st">"2006/12 - converting Year of birth character date to numeric"</span>)</span>
<span id="cb1-51"><a href="#cb1-51"></a>                      tmp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">d+$"</span>, x), x, <span class="cn">NA</span>))</span>
<span id="cb1-52"><a href="#cb1-52"></a>                      tmp[<span class="fu">as.numeric</span>(tmp) <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>                    }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">cur_column</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CLCUSE301"</span>, <span class="st">"CLCUSE302"</span>, <span class="st">"Deffort"</span>) <span class="sc">&amp;</span> </span>
<span id="cb1-54"><a href="#cb1-54"></a>                             <span class="st">"character"</span> <span class="sc">%in%</span> <span class="fu">class</span>(x)){</span>
<span id="cb1-55"><a href="#cb1-55"></a>                      <span class="co"># for 2012 when Effort-real  is a character?!</span></span>
<span id="cb1-56"><a href="#cb1-56"></a>                      <span class="fu">message</span>(<span class="st">"2012 - converting Effort-real/Deffort character to numeric"</span>)</span>
<span id="cb1-57"><a href="#cb1-57"></a>                      tmp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">d+$"</span>, x), x, <span class="cn">NA</span>))</span>
<span id="cb1-58"><a href="#cb1-58"></a>                      tmp[<span class="fu">as.numeric</span>(tmp) <span class="sc">==</span> <span class="dv">99</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>                    }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">cur_column</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"VER_STU"</span>)){</span>
<span id="cb1-60"><a href="#cb1-60"></a>                      <span class="co"># attr(,"format.spss")</span></span>
<span id="cb1-61"><a href="#cb1-61"></a>                      <span class="co"># [1] "A7"</span></span>
<span id="cb1-62"><a href="#cb1-62"></a>                      <span class="fu">message</span>(<span class="st">"dealing with plain text from 2012 VERSTU"</span>)</span>
<span id="cb1-63"><a href="#cb1-63"></a>                      tmp <span class="ot">&lt;-</span> <span class="fu">as.character</span>(x)</span>
<span id="cb1-64"><a href="#cb1-64"></a>                    }</span>
<span id="cb1-65"><a href="#cb1-65"></a>                    <span class="cf">else</span>{</span>
<span id="cb1-66"><a href="#cb1-66"></a>                      <span class="cf">if</span>(<span class="fu">is.null</span>(<span class="fu">names</span>(x)[<span class="dv">1</span>])){</span>
<span id="cb1-67"><a href="#cb1-67"></a>                        first_name <span class="ot">&lt;-</span> <span class="st">""</span></span>
<span id="cb1-68"><a href="#cb1-68"></a>                      }<span class="cf">else</span>{</span>
<span id="cb1-69"><a href="#cb1-69"></a>                        first_name <span class="ot">&lt;-</span> <span class="fu">names</span>(x)[<span class="dv">1</span>]</span>
<span id="cb1-70"><a href="#cb1-70"></a>                      }</span>
<span id="cb1-71"><a href="#cb1-71"></a>                      </span>
<span id="cb1-72"><a href="#cb1-72"></a>                      <span class="cf">if</span>(first_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"SCHOOLID"</span>,<span class="st">"StIDStd"</span>, <span class="st">"ST03Q01"</span>)){</span>
<span id="cb1-73"><a href="#cb1-73"></a></span>
<span id="cb1-74"><a href="#cb1-74"></a>                        <span class="co">#grepl("[a-zA-Z]", x[1]) # check to see if text contains character</span></span>
<span id="cb1-75"><a href="#cb1-75"></a>                        </span>
<span id="cb1-76"><a href="#cb1-76"></a>                        <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"&gt;&gt; {names(x)[1]} for 2012 so... character?"</span>))</span>
<span id="cb1-77"><a href="#cb1-77"></a>                        tmp <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">as.character</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1-78"><a href="#cb1-78"></a>                        </span>
<span id="cb1-79"><a href="#cb1-79"></a>                        <span class="co"># filter out the dodgy NA values</span></span>
<span id="cb1-80"><a href="#cb1-80"></a>                        tmp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(tmp) <span class="sc">%in%</span> x_lbls,<span class="cn">NA</span>, tmp)</span>
<span id="cb1-81"><a href="#cb1-81"></a>                        </span>
<span id="cb1-82"><a href="#cb1-82"></a>                        <span class="co"># tmp &lt;- x # can't convert to numeric?!</span></span>
<span id="cb1-83"><a href="#cb1-83"></a>                        <span class="fu">range</span>(tmp, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-84"><a href="#cb1-84"></a>                        </span>
<span id="cb1-85"><a href="#cb1-85"></a>                      <span class="co"># if the labels are only for missing data set them to NA</span></span>
<span id="cb1-86"><a href="#cb1-86"></a>                      }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">setequal</span>(<span class="fu">names</span>(x_lbls), dodgy)){</span>
<span id="cb1-87"><a href="#cb1-87"></a>                        <span class="co"># replace any labelled data with NA</span></span>
<span id="cb1-88"><a href="#cb1-88"></a>                       <span class="fu">message</span>(<span class="st">"&gt;&gt; only missing labels, going numeric"</span>)</span>
<span id="cb1-89"><a href="#cb1-89"></a>                       <span class="fu">message</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>])</span>
<span id="cb1-90"><a href="#cb1-90"></a>                       tmp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">as.numeric</span>(x) <span class="sc">%in%</span> x_lbls,<span class="cn">NA</span>, x)</span>
<span id="cb1-91"><a href="#cb1-91"></a>                        </span>
<span id="cb1-92"><a href="#cb1-92"></a>                      <span class="co"># check that levels only contain 90s, if so likely numeric!</span></span>
<span id="cb1-93"><a href="#cb1-93"></a>                      }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">as.numeric</span>(x_lbls) <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> </span>
<span id="cb1-94"><a href="#cb1-94"></a>                             <span class="fu">as.numeric</span>(x_lbls) <span class="sc">&lt;</span> <span class="dv">100</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">==</span> <span class="fu">length</span>(x_lbls)){</span>
<span id="cb1-95"><a href="#cb1-95"></a>                        <span class="fu">message</span>(<span class="st">"&gt;&gt; converting to numeric"</span>)</span>
<span id="cb1-96"><a href="#cb1-96"></a>                        tmp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;=</span> <span class="dv">90</span>,<span class="cn">NA</span>, x)</span>
<span id="cb1-97"><a href="#cb1-97"></a>                      }<span class="cf">else</span> <span class="cf">if</span>(<span class="fu">sum</span>(<span class="fu">as.numeric</span>(x_lbls) <span class="sc">%in%</span> dodgy_labels) <span class="sc">==</span> <span class="fu">length</span>(x_lbls)){</span>
<span id="cb1-98"><a href="#cb1-98"></a>                        <span class="fu">message</span>(<span class="st">"&gt;&gt; weird LMINS etc"</span>)</span>
<span id="cb1-99"><a href="#cb1-99"></a>                        tmp <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">%in%</span> dodgy_labels,<span class="cn">NA</span>, x)</span>
<span id="cb1-100"><a href="#cb1-100"></a>                      }<span class="cf">else</span>{</span>
<span id="cb1-101"><a href="#cb1-101"></a>                        <span class="fu">message</span>(<span class="st">"&gt;&gt; normal factor"</span>)</span>
<span id="cb1-102"><a href="#cb1-102"></a>                        tmp <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">as_factor</span>(x)</span>
<span id="cb1-103"><a href="#cb1-103"></a>                      }</span>
<span id="cb1-104"><a href="#cb1-104"></a>                    }</span>
<span id="cb1-105"><a href="#cb1-105"></a>                    <span class="co"># re attach label to each column</span></span>
<span id="cb1-106"><a href="#cb1-106"></a>                    <span class="fu">attr</span>(tmp,<span class="st">"label"</span>) <span class="ot">&lt;-</span> lbls[<span class="fu">cur_column</span>()][[<span class="dv">1</span>]]</span>
<span id="cb1-107"><a href="#cb1-107"></a>                    <span class="fu">message</span>()</span>
<span id="cb1-108"><a href="#cb1-108"></a>                    <span class="fu">return</span>(tmp)</span>
<span id="cb1-109"><a href="#cb1-109"></a>                  }</span>
<span id="cb1-110"><a href="#cb1-110"></a>    ))</span>
<span id="cb1-111"><a href="#cb1-111"></a> <span class="fu">return</span>(dfc) </span>
<span id="cb1-112"><a href="#cb1-112"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Finally, load the <code>.sav</code> file into R, run the conversion function, and save back to <code>.parquet</code> format:</p>
<div class="cell">
<details class="code-fold"><summary>conversion code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># G:\My Drive\Kings\Code\PISR\code\</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(glue)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(labelled)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(haven)</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>base_folder <span class="ot">&lt;-</span> <span class="st">"where/the/sav/files/are/stored/"</span></span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>loc <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{base_folder}pisa_student_2022.sav"</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>df <span class="ot">&lt;-</span> <span class="fu">read_spss</span>(loc) <span class="co"># using haven</span></span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a>PISA_2022 <span class="ot">&lt;-</span> <span class="fu">PISA_factorise</span>(df) <span class="co"># custom conversion code</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="fu">write_parquet</span>(PISA_2022, <span class="fu">glue</span>(<span class="st">"{base_folder}pisa_student_2022.parquet"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section></section><section id="common-issues" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Common issues</h1>
<p>The PISA datasets can be absolutely huge and might bring your computer to its knees; if you are using a computer with less than 16GB of RAM you might not be able to load some tables at all. Tables such as the <em>Cognitive</em> dataset have hundreds of thousands of rows and thousands of columns, loading them directly might lead to an error similar to this: <code>Error: cannot allocate vector of size 2.1 Gb</code>. This means that R can’t find enough RAM to load the dataset and has given up. You can see a rough estimate of how much RAM R is currently using the top Environment panel:</p>
<p><img src="../images/environment-RAM.png" class="img-fluid"></p>
<p>To get around this issues you can try to clean your current R environment using the brush tool:</p>
<p><img src="../images/environment-brush.png" class="img-fluid"></p>
<p>This will drop all the current dataframes, objects, functions and packages that you have loaded meaning you will have to reload packages such as <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> and <code><a href="https://haven.tidyverse.org">library(haven)</a></code> before you can attempt to reload the PISA tables.</p>
<p>A lack of RAM might also be the result of lots of other programs running concurrently on your computer. Try to close anything that you don’t need, web browsers can be particularly RAM hungry, so close them or as many tabs as you can.</p>
<p>If none of the above works, then please get in touch with the team, letting them know which table you need from which year, with which fields and for which countries. We will be able to provide you with a cutdown dataset.</p>
</section><section id="publishing-your-pisa-analysis" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Publishing your PISA analysis</h1>
<p>So far you have been dealing with a subset of the data and the <code>PV1</code> fields. Published analysis of PISA data, as with many other large scale data sets involves the <em>weighted</em> use of <em>plausible values</em>. In a nutshell the raw student sample from each country might not be a perfect representation of that country’s student population and the results of some students need to carry more <em>weight</em> than others to give you a proper picture of how that country is performing. Within a country, students won’t be able to complete every test element in the PISA question bank, so a range of <em>plausible values</em> are produced that predict how a students might have done if they had sat all the questions, based on their answers for the questions that they did sit. Due to these reasons, and others, you should always look at publications that refer to PISA with a certain degree of skepticism. A useful place to feed your skepticism is Jerrim’s 2020 video on <a href="https://www.youtube.com/watch?v=Yrud2pi5NOQ">Should the PISA findings be trusted?</a></p>
<blockquote class="blockquote">
<p>“Almost nobody knows exactly where the OECD numbers come from” - Jerrim 2020</p>
</blockquote>
<section id="sec-PV" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="sec-PV">
<span class="header-section-number">4.1</span> Plausible Values</h2>
<p>In the PISA dataset, the outcomes of student tests are reported as plausible values, for example, in the variables of the science test (<code>PV1SCIE</code>, <code>PV2SCIE</code>, <code>PV3SCIE</code>, <code>PV3SCIE</code>, and <code>PV5SCIE</code>). It might seem counter intuitive that there are five or ten values for a score on a test. (note PISA published five plausible values before 2015, when they increased the number of plausible values to ten)</p>
<p>Plausible values (PVs) are a way of expressing the error in a measurement. The number of questions in the full PISA survey is very large, so students are randomly allocated to take a subset of questions (and even then, the test still takes two hours!). As no student completes the full set of questions - only 40% of students even answer questions in reading, science and mathematics <span class="citation" data-cites="OECD2014technical">(<a href="#ref-OECD2014technical" role="doc-biblioref">OECD 2014</a>)</span> - estimating how a student would have performed on the full question set involves some error. Plausible values are a way of expressing the uncertainty in the estimation of student scores.</p>
<p>One way of thinking of the PV scores is that they represent five or ten different estimates of students’ abilities based on the questions they have answered. To decrease measurement error, five different approaches are applied to create five different estimates, the PV scores.</p>
<p>The PISA Data Analysis Manual suggests:</p>
<blockquote class="blockquote">
<p>Population statistics should be estimated using each plausible value separately. The reported population statistic is then the average of each plausible value statistic. For instance, if one is interested in the correlation coefficient between the social index and the reading performance in PISA, then five correlation coefficients should be computed and then averaged</p>
<p>Plausible values should never be averaged at the student level, i.e.&nbsp;by computing in the dataset the mean of the five plausible values at the student level and then computing the statistic of interest once using that average PV value. Doing so would be equivalent to an EAP estimate, with a bias as described in the previous section.</p>
<p><span class="citation" data-cites="monseur2009pisa">(<a href="#ref-monseur2009pisa" role="doc-biblioref">Monseur et al. 2009, 100</a>)</span></p>
</blockquote>
<p>The actual PV values can differ substantially from each, for example if we work out the scaled (normalised) value for a PV value, that is how many standard deviations from the mean of other PV values a student gets we can see large fluctuations. For student 5, PV1SCIE is 0.147 standard deviations <em>lower</em> than the average of all students, but when we look at their PV2SCIE score, we see it is 1.10 standard deviations <em>higher</em>:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">mutate</span>(<span class="at">PV1SCIE_z =</span> <span class="fu">scale</span>(PV1SCIE),</span>
<span id="cb3-3"><a href="#cb3-3"></a>         <span class="at">PV2SCIE_z =</span> <span class="fu">scale</span>(PV2SCIE)) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">select</span>(PV1SCIE, PV2SCIE,</span>
<span id="cb3-5"><a href="#cb3-5"></a>         PV1SCIE_z, PV2SCIE_z)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 613,744 × 4
    PV1SCIE PV2SCIE PV1SCIE_z[,1] PV2SCIE_z[,1]
      &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
  1    335.    296.      -1.09         -1.47   
  2    315.    327.      -1.29         -1.17   
  3    359.    345.      -0.872        -1.00   
  4    215.    192.      -2.24         -2.45   
  5    435.    566.      -0.147         1.10   
  6    479.    482.       0.272         0.298  
  7    342.    290.      -1.03         -1.52   
  8    323.    359.      -1.22         -0.865  
  9    361.    362.      -0.854        -0.840  
 10    386.    427.      -0.614        -0.221  
 11    346.    322.      -0.990        -1.22   
 12    414.    432.      -0.346        -0.177  
 13    288.    332.      -1.55         -1.13   
 14    327.    362.      -1.18         -0.841  
 15    446.    459.      -0.0391        0.0835 
 16    340.    314.      -1.05         -1.29   
 17    394.    374.      -0.539        -0.725  
 18    569.    466.       1.13          0.153  
 19    386.    360.      -0.610        -0.863  
 20    369.    308.      -0.772        -1.35   
 21    468.    401.       0.170        -0.471  
 22    358.    273.      -0.882        -1.69   
 23    386.    369.      -0.615        -0.770  
 24    357.    410.      -0.884        -0.387  
 25    446.    435.      -0.0409       -0.147  
 26    298.    321.      -1.45         -1.23   
 27    412.    447.      -0.367        -0.0278 
 28    348.    365.      -0.975        -0.814  
 29    393.    430.      -0.541        -0.191  
 30    421.    395.      -0.282        -0.529  
 31    254.    214.      -1.87         -2.24   
 32    325.    321.      -1.19         -1.23   
 33    565.    546.       1.09          0.906  
 34    289.    267.      -1.54         -1.74   
 35    481.    476.       0.295         0.240  
 36    302.    333.      -1.42         -1.11   
 37    331.    319.      -1.13         -1.25   
 38    288.    257.      -1.54         -1.83   
 39    453.    391.       0.0237       -0.563  
 40    468.    611.       0.166         1.52   
 41    387.    387.      -0.604        -0.607  
 42    302.    311.      -1.41         -1.32   
 43    415.    507.      -0.335         0.539  
 44    288.    350.      -1.54         -0.956  
 45    227.    181.      -2.12         -2.56   
 46    452.    468.       0.0143        0.167  
 47    236.    176.      -2.04         -2.61   
 48    297.    330.      -1.45         -1.15   
 49    374.    321.      -0.729        -1.23   
 50    393.    358.      -0.549        -0.876  
 51    335.    356.      -1.10         -0.892  
 52    379.    359.      -0.678        -0.866  
 53    443.    483.      -0.0669        0.314  
 54    287.    266.      -1.55         -1.75   
 55    345.    267.      -1.000        -1.74   
 56    409.    417.      -0.391        -0.320  
 57    426.    359.      -0.235        -0.872  
 58    321.    286.      -1.23         -1.56   
 59    347.    329.      -0.981        -1.15   
 60    484.    468.       0.321         0.168  
 61    362.    293.      -0.844        -1.50   
 62    392.    382.      -0.559        -0.652  
 63    395.    424.      -0.524        -0.246  
 64    426.    445.      -0.237        -0.0474 
 65    328.    327.      -1.16         -1.17   
 66    398.    439.      -0.498        -0.104  
 67    315.    215.      -1.29         -2.24   
 68    540.    453.       0.854         0.0284 
 69    384.    408.      -0.629        -0.407  
 70    510.    464.       0.569         0.129  
 71    381.    367.      -0.663        -0.791  
 72    435.    375.      -0.145        -0.713  
 73    280.    294.      -1.62         -1.49   
 74    499.    489.       0.460         0.364  
 75    413.    450.      -0.359        -0.00711
 76    375.    285.      -0.714        -1.57   
 77    406.    385.      -0.419        -0.622  
 78    247.    231.      -1.94         -2.09   
 79    335.    366.      -1.10         -0.799  
 80    492.    438.       0.393        -0.115  
 81    463.    461.       0.121         0.103  
 82    324.    296.      -1.20         -1.47   
 83    264.    307.      -1.77         -1.36   
 84    288.    282.      -1.54         -1.60   
 85    308.    281.      -1.36         -1.61   
 86    303.    244.      -1.40         -1.96   
 87    274.    271.      -1.67         -1.71   
 88    311.    204.      -1.32         -2.34   
 89    401.    351.      -0.467        -0.944  
 90    338.    336.      -1.07         -1.08   
 91    376.    400.      -0.711        -0.475  
 92    330.    309.      -1.14         -1.34   
 93    354.    433.      -0.920        -0.166  
 94    358.    420.      -0.879        -0.290  
 95    304.    347.      -1.39         -0.981  
 96    362.    362.      -0.839        -0.840  
 97    355.    386.      -0.902        -0.612  
 98    396.    420.      -0.516        -0.288  
 99    376.    412.      -0.708        -0.368  
100    317.    266.      -1.27         -1.75   
101    275.    385.      -1.67         -0.622  
102    397.    394.      -0.509        -0.535  
103    347.    351.      -0.982        -0.948  
104    338.    398.      -1.07         -0.499  
105    229.    333.      -2.10         -1.12   
106    320.    349.      -1.24         -0.959  
107    490.    415.       0.375        -0.340  
108    422.    464.      -0.273         0.133  
109    357.    208.      -0.886        -2.31   
110    542.    556.       0.871         1.01   
111    273.    340.      -1.69         -1.05   
112    541.    496.       0.862         0.432  
113    305.    335.      -1.38         -1.10   
114    496.    476.       0.437         0.242  
115    260.    320.      -1.81         -1.24   
116    318.    317.      -1.26         -1.27   
117    327.    307.      -1.17         -1.36   
118    260.    273.      -1.81         -1.69   
119    315.    331.      -1.28         -1.13   
120    326.    300.      -1.18         -1.43   
121    402.    420.      -0.460        -0.286  
122    398.    425.      -0.500        -0.240  
123    216.    261.      -2.23         -1.80   
124    362.    321.      -0.839        -1.23   
125    361.    361.      -0.849        -0.846  
126    361.    312.      -0.853        -1.32   
127    423.    446.      -0.257        -0.0386 
128    320.    348.      -1.24         -0.971  
129    372.    448.      -0.745        -0.0212 
130    256.    182.      -1.85         -2.55   
131    456.    495.       0.0523        0.429  
132    345.    363.      -0.998        -0.826  
133    463.    497.       0.115         0.445  
134    408.    385.      -0.405        -0.623  
135    401.    447.      -0.465        -0.0340 
136    337.    364.      -1.08         -0.817  
137    320.    326.      -1.24         -1.18   
138    474.    458.       0.220         0.0719 
139    430.    465.      -0.197         0.142  
140    517.    515.       0.632         0.616  
141    317.    359.      -1.27         -0.869  
142    364.    360.      -0.826        -0.857  
143    490.    540.       0.378         0.852  
144    316.    311.      -1.28         -1.32   
145    307.    346.      -1.36         -0.994  
146    375.    424.      -0.722        -0.248  
147    328.    314.      -1.17         -1.30   
148    275.    290.      -1.66         -1.53   
149    249.    307.      -1.92         -1.37   
150    334.    314.      -1.11         -1.30   
151    258.    299.      -1.83         -1.44   
152    437.    420.      -0.126        -0.285  
153    312.    233.      -1.31         -2.06   
154    297.    332.      -1.45         -1.12   
155    426.    574.      -0.230         1.18   
156    476.    429.       0.243        -0.199  
157    339.    407.      -1.06         -0.408  
158    360.    449.      -0.860        -0.0116 
159    394.    357.      -0.534        -0.885  
160    428.    371.      -0.216        -0.753  
161    424.    409.      -0.253        -0.390  
162    347.    331.      -0.985        -1.14   
163    343.    370.      -1.02         -0.762  
164    286.    290.      -1.57         -1.52   
165    538.    532.       0.829         0.778  
166    327.    336.      -1.17         -1.09   
167    337.    350.      -1.08         -0.955  
168    347.    319.      -0.984        -1.25   
169    356.    269.      -0.893        -1.72   
170    368.    302.      -0.780        -1.41   
171    360.    395.      -0.861        -0.524  
172    457.    460.       0.0668        0.0958 
173    241.    288.      -1.99         -1.54   
174    359.    316.      -0.867        -1.28   
175    321.    316.      -1.23         -1.27   
176    245.    248.      -1.95         -1.92   
177    360.    317.      -0.862        -1.26   
178    391.    369.      -0.569        -0.776  
179    382.    276.      -0.654        -1.65   
180    291.    317.      -1.52         -1.27   
181    408.    405.      -0.401        -0.432  
182    274.    281.      -1.68         -1.61   
183    279.    281.      -1.63         -1.61   
184    292.    278.      -1.51         -1.64   
185    473.    446.       0.212        -0.0439 
186    380.    369.      -0.665        -0.772  
187    261.    298.      -1.80         -1.45   
188    464.    503.       0.127         0.499  
189    356.    351.      -0.898        -0.947  
190    340.    389.      -1.05         -0.580  
191    381.    293.      -0.663        -1.50   
192    472.    445.       0.201        -0.0537 
193    326.    313.      -1.19         -1.31   
194    318.    322.      -1.25         -1.22   
195    454.    454.       0.0382        0.0332 
196    287.    187.      -1.55         -2.50   
197    353.    360.      -0.929        -0.860  
198    511.    523.       0.575         0.692  
199    290.    296.      -1.52         -1.47   
200    564.    540.       1.08          0.856  
201    370.    391.      -0.766        -0.567  
202    456.    500.       0.0521        0.472  
203    251.    288.      -1.89         -1.54   
204    406.    385.      -0.421        -0.624  
205    238.    287.      -2.01         -1.55   
206    397.    384.      -0.503        -0.633  
207    426.    488.      -0.236         0.360  
208    422.    433.      -0.274        -0.169  
209    251.    379.      -1.90         -0.677  
210    542.    531.       0.871         0.767  
211    480.    448.       0.279        -0.0238 
212    268.    237.      -1.73         -2.03   
213    448.    446.      -0.0271       -0.0390 
214    317.    389.      -1.26         -0.581  
215    347.    249.      -0.984        -1.92   
216    360.    324.      -0.858        -1.20   
217    380.    383.      -0.667        -0.641  
218    274.    278.      -1.67         -1.64   
219    358.    361.      -0.874        -0.850  
220    358.    445.      -0.877        -0.0548 
221    270.    318.      -1.72         -1.26   
222    305.    264.      -1.38         -1.77   
223    369.    287.      -0.777        -1.55   
224    456.    532.       0.0524        0.781  
225    422.    432.      -0.275        -0.175  
226    282.    389.      -1.60         -0.580  
227    317.    375.      -1.26         -0.715  
228    363.    321.      -0.829        -1.23   
229    509.    492.       0.558         0.393  
230    377.    321.      -0.697        -1.23   
231    484.    507.       0.315         0.536  
232    379.    387.      -0.679        -0.603  
233    301.    310.      -1.42         -1.33   
234    405.    438.      -0.429        -0.115  
235    297.    276.      -1.46         -1.65   
236    436.    399.      -0.138        -0.484  
237    449.    460.      -0.0137        0.0918 
238    460.    567.       0.0912        1.11   
239    393.    343.      -0.544        -1.02   
240    587.    501.       1.30          0.477  
241    300.    275.      -1.43         -1.67   
242    460.    446.       0.0906       -0.0375 
243    402.    362.      -0.457        -0.842  
244    490.    494.       0.373         0.416  
245    389.    389.      -0.584        -0.582  
246    293.    276.      -1.49         -1.66   
247    434.    440.      -0.153        -0.102  
248    341.    400.      -1.04         -0.476  
249    323.    354.      -1.21         -0.916  
250    423.    438.      -0.261        -0.120  
251    320.    372.      -1.24         -0.748  
252    409.    391.      -0.395        -0.561  
253    522.    524.       0.684         0.702  
254    365.    346.      -0.812        -0.991  
255    496.    453.       0.436         0.0270 
256    468.    469.       0.162         0.174  
257    415.    441.      -0.338        -0.0866 
258    304.    414.      -1.39         -0.349  
259    273.    321.      -1.68         -1.23   
260    273.    264.      -1.68         -1.77   
261    344.    278.      -1.01         -1.64   
262    263.    314.      -1.78         -1.30   
263    310.    346.      -1.34         -0.991  
264    491.    437.       0.386        -0.126  
265    418.    396.      -0.306        -0.516  
266    523.    565.       0.685         1.09   
267    418.    406.      -0.306        -0.424  
268    312.    349.      -1.31         -0.962  
269    400.    300.      -0.478        -1.43   
270    330.    333.      -1.15         -1.12   
271    501.    435.       0.482        -0.148  
272    418.    436.      -0.312        -0.137  
273    425.    387.      -0.246        -0.598  
274    311.    318.      -1.32         -1.26   
275    469.    464.       0.178         0.129  
276    335.    283.      -1.10         -1.59   
277    575.    450.       1.18         -0.00740
278    368.    432.      -0.780        -0.170  
279    242.    281.      -1.98         -1.61   
280    515.    543.       0.615         0.876  
281    423.    310.      -0.262        -1.33   
282    344.    284.      -1.01         -1.58   
283    338.    327.      -1.06         -1.17   
284    305.    357.      -1.38         -0.889  
285    302.    310.      -1.41         -1.33   
286    411.    418.      -0.376        -0.307  
287    333.    343.      -1.11         -1.02   
288    262.    243.      -1.79         -1.97   
289    399.    366.      -0.485        -0.805  
290    338.    375.      -1.07         -0.712  
291    405.    356.      -0.433        -0.899  
292    428.    422.      -0.214        -0.273  
293    284.    277.      -1.58         -1.65   
294    341.    380.      -1.04         -0.664  
295    319.    371.      -1.25         -0.758  
296    401.    294.      -0.467        -1.49   
297    282.    317.      -1.60         -1.26   
298    381.    336.      -0.656        -1.09   
299    255.    268.      -1.86         -1.73   
300    467.    436.       0.162        -0.141  
301    367.    310.      -0.796        -1.34   
302    526.    546.       0.721         0.909  
303    325.    329.      -1.19         -1.16   
304    458.    430.       0.0747       -0.189  
305    312.    340.      -1.31         -1.04   
306    404.    401.      -0.443        -0.465  
307    412.    415.      -0.362        -0.338  
308    397.    340.      -0.507        -1.05   
309    420.    351.      -0.291        -0.941  
310    352.    459.      -0.937         0.0791 
311    577.    619.       1.20          1.61   
312    371.    384.      -0.757        -0.629  
313    290.    357.      -1.52         -0.885  
314    329.    226.      -1.16         -2.13   
315    435.    461.      -0.151         0.0994 
316    379.    367.      -0.679        -0.789  
317    572.    455.       1.16          0.0454 
318    487.    528.       0.350         0.743  
319    291.    336.      -1.52         -1.09   
320    266.    377.      -1.76         -0.693  
321    369.    379.      -0.769        -0.678  
322    314.    375.      -1.30         -0.713  
323    443.    349.      -0.0708       -0.963  
324    400.    414.      -0.478        -0.349  
325    404.    404.      -0.442        -0.441  
326    399.    366.      -0.487        -0.798  
327    367.    296.      -0.796        -1.47   
328    576.    634.       1.19          1.75   
329    288.    208.      -1.54         -2.30   
330    355.    313.      -0.904        -1.31   
331    467.    444.       0.159        -0.0615 
332    388.    326.      -0.591        -1.19   
333    231.    293.      -2.08         -1.50   
334    450.    442.      -0.00559      -0.0833 
335    490.    485.       0.377         0.328  
336    423.    424.      -0.263        -0.246  
337    217.    314.      -2.22         -1.30   
338    345.    353.      -1.00         -0.928  
339    464.    479.       0.130         0.275  
340    390.    342.      -0.579        -1.03   
341    439.    445.      -0.108        -0.0514 
342    289.    276.      -1.54         -1.65   
343    335.    302.      -1.09         -1.41   
344    236.    271.      -2.04         -1.70   
345    278.    445.      -1.64         -0.0533 
346    299.    414.      -1.44         -0.348  
347    324.    379.      -1.20         -0.679  
348    504.    491.       0.511         0.383  
349    270.    272.      -1.72         -1.69   
350    419.    462.      -0.297         0.112  
351    374.    417.      -0.729        -0.321  
352    224.    343.      -2.15         -1.02   
353    319.    345.      -1.25         -1.01   
354    401.    436.      -0.466        -0.137  
355    234.    196.      -2.05         -2.42   
356    401.    373.      -0.467        -0.733  
357    326.    345.      -1.19         -1.00   
358    430.    437.      -0.194        -0.127  
359    292.    245.      -1.51         -1.95   
360    436.    491.      -0.140         0.383  
361    489.    471.       0.363         0.196  
362    439.    391.      -0.105        -0.565  
363    345.    318.      -1.00         -1.26   
364    201.    310.      -2.37         -1.34   
365    521.    515.       0.666         0.612  
366    428.    493.      -0.214         0.408  
367    240.    268.      -2.00         -1.73   
368    231.    289.      -2.08         -1.53   
369    379.    310.      -0.683        -1.33   
370    378.    469.      -0.685         0.180  
371    410.    399.      -0.384        -0.491  
372    363.    354.      -0.826        -0.913  
373    194.    285.      -2.44         -1.57   
374    446.    322.      -0.0454       -1.22   
375    375.    360.      -0.714        -0.859  
376    275.    374.      -1.67         -0.725  
377    434.    391.      -0.158        -0.563  
378    281.    246.      -1.61         -1.94   
379    457.    503.       0.0629        0.503  
380    384.    360.      -0.631        -0.859  
381    311.    359.      -1.32         -0.864  
382    328.    311.      -1.17         -1.32   
383    318.    254.      -1.26         -1.86   
384    286.    270.      -1.56         -1.72   
385    311.    316.      -1.33         -1.27   
386    225.    355.      -2.14         -0.901  
387    292.    248.      -1.50         -1.92   
388    391.    359.      -0.562        -0.871  
389    470.    571.       0.182         1.15   
390    229.    303.      -2.10         -1.40   
391    525.    505.       0.705         0.518  
392    308.    284.      -1.35         -1.58   
393    303.    313.      -1.41         -1.30   
394    280.    321.      -1.62         -1.23   
395    371.    357.      -0.756        -0.888  
396    341.    389.      -1.04         -0.582  
397    453.    463.       0.0203        0.121  
398    417.    390.      -0.319        -0.574  
399    324.    262.      -1.20         -1.79   
400    269.    205.      -1.73         -2.33   
401    379.    394.      -0.677        -0.537  
402    304.    358.      -1.39         -0.874  
403    457.    412.       0.0654       -0.365  
404    334.    371.      -1.10         -0.752  
405    279.    358.      -1.63         -0.881  
406    388.    351.      -0.595        -0.946  
407    355.    313.      -0.903        -1.30   
408    341.    353.      -1.04         -0.921  
409    310.    316.      -1.33         -1.28   
410    353.    376.      -0.927        -0.707  
411    299.    310.      -1.44         -1.33   
412    571.    461.       1.14          0.0984 
413    220.    290.      -2.19         -1.52   
414    330.    298.      -1.14         -1.44   
415    351.    325.      -0.942        -1.19   
416    339.    334.      -1.06         -1.10   
417    506.    479.       0.531         0.274  
418    412.    305.      -0.367        -1.38   
419    514.    487.       0.605         0.349  
420    328.    326.      -1.16         -1.18   
421    393.    331.      -0.548        -1.14   
422    374.    481.      -0.730         0.293  
423    313.    294.      -1.30         -1.49   
424    424.    442.      -0.248        -0.0760 
425    338.    380.      -1.07         -0.670  
426    366.    373.      -0.801        -0.736  
427    369.    337.      -0.773        -1.08   
428    296.    293.      -1.47         -1.49   
429    405.    399.      -0.432        -0.484  
430    394.    464.      -0.534         0.126  
431    291.    292.      -1.52         -1.50   
432    176.    119.      -2.61         -3.15   
433    477.    391.       0.254        -0.560  
434    330.    384.      -1.14         -0.627  
435    348.    316.      -0.973        -1.28   
436    372.    377.      -0.746        -0.694  
437    460.    454.       0.0915        0.0311 
438    273.    297.      -1.69         -1.46   
439    306.    203.      -1.37         -2.35   
440    378.    312.      -0.690        -1.32   
441    487.    492.       0.345         0.400  
442    301.    326.      -1.42         -1.18   
443    342.    419.      -1.03         -0.295  
444    348.    370.      -0.976        -0.765  
445    452.    437.       0.0163       -0.127  
446    373.    383.      -0.736        -0.644  
447    276.    303.      -1.66         -1.40   
448    438.    351.      -0.120        -0.945  
449    408.    305.      -0.403        -1.39   
450    436.    428.      -0.139        -0.213  
451    343.    318.      -1.02         -1.26   
452    315.    351.      -1.28         -0.941  
453    355.    397.      -0.911        -0.506  
454    343.    379.      -1.02         -0.679  
455    550.    481.       0.943         0.294  
456    341.    309.      -1.04         -1.35   
457    372.    431.      -0.746        -0.184  
458    375.    357.      -0.712        -0.885  
459    318.    304.      -1.26         -1.39   
460    303.    239.      -1.40         -2.01   
461    352.    325.      -0.940        -1.19   
462    516.    437.       0.625        -0.126  
463    425.    372.      -0.238        -0.749  
464    240.    381.      -2.00         -0.660  
465    317.    373.      -1.27         -0.736  
466    521.    490.       0.673         0.376  
467    253.    297.      -1.87         -1.46   
468    419.    489.      -0.300         0.367  
469    218.    229.      -2.21         -2.11   
470    263.    281.      -1.78         -1.61   
471    530.    516.       0.758         0.624  
472    379.    402.      -0.678        -0.461  
473    418.    443.      -0.304        -0.0689 
474    431.    391.      -0.185        -0.562  
475    420.    377.      -0.294        -0.701  
476    436.    534.      -0.134         0.793  
477    274.    324.      -1.68         -1.20   
478    328.    382.      -1.16         -0.650  
479    455.    402.       0.0388       -0.457  
480    340.    314.      -1.05         -1.29   
481    340.    347.      -1.05         -0.979  
482    359.    395.      -0.867        -0.526  
483    548.    464.       0.922         0.127  
484    397.    402.      -0.510        -0.456  
485    343.    423.      -1.02         -0.257  
486    269.    244.      -1.73         -1.96   
487    430.    503.      -0.196         0.505  
488    285.    328.      -1.57         -1.16   
489    288.    210.      -1.55         -2.28   
490    354.    329.      -0.915        -1.15   
491    320.    341.      -1.24         -1.03   
492    304.    275.      -1.39         -1.66   
493    259.    332.      -1.82         -1.12   
494    584.    526.       1.26          0.717  
495    499.    483.       0.462         0.313  
496    460.    402.       0.0881       -0.463  
497    370.    374.      -0.768        -0.722  
498    333.    355.      -1.11         -0.903  
499    434.    422.      -0.158        -0.269  
500    287.    321.      -1.55         -1.23   
# ℹ 613,244 more rows</code></pre>
</div>
</div>
<p>These differences make analysis at an individual student level hard to justify, though overall population or sub population scores will be more reliable. One approach that we could take to resolve the issue with using a single PV values would be to to look at using the average (here, taken to be the <em>mean</em>) of several PV scores. To calculate the mean of ten PV values, do the following (it might take some time to complete this calculation!):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">mutate</span>(<span class="at">PV_SCIE_m =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">matches</span>(<span class="st">"PV[0-9]+SCIE"</span>))),</span>
<span id="cb5-4"><a href="#cb5-4"></a>         <span class="at">PV_MATH_m =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">matches</span>(<span class="st">"PV[0-9]+MATH"</span>))),</span>
<span id="cb5-5"><a href="#cb5-5"></a>         <span class="at">PV_READ_m =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">matches</span>(<span class="st">"PV[0-9]+READ"</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="co"># to get rid of the rowwise operator</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>  <span class="fu">select</span>(PV_SCIE_m, PV_MATH_m, PV_READ_m)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This isn’t a perfect solution, and below we will take you through using Plausible Values correctly.</p>
</section><section id="what-are-weights" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="what-are-weights">
<span class="header-section-number">4.2</span> What are weights</h2>
<p>The PISA data set contains two weighting variables that allow you to look at student outcomes that represent a country population accurately, and to compare countries against each other. When running our analysis, if we want it to be representative of the population, and allow for comparisons between countries, we should really be looking at the weighted scores. Luckily this can be easily done in R.</p>
<section id="student-weights" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="student-weights">
<span class="header-section-number">4.2.1</span> Student weights</h3>
<p>The <em>student weight</em>, <code>W_FSTUWT</code>, represents the probability of an individual student being selected within a given country. For example, if PISA only sampled students from England for the UK results, then taking the mean Maths scores from these students probably wouldn’t be a representative score for all students in the <em>UK</em> including those from Wales, Scotland and Northern Ireland. In pratice PISA tries to sample students from all over a country, but it’s unlikely that the likelihood of a student being sampled in each region will be equal, it might also be the case that other factors are skewed, e.g.&nbsp;students from cities are more likely to be sampled than those from the countryside, or more affluent schools are more likely to be sampled than impoverished ones. To try and provide an accurate representation of the responses for different types of students across a whole country, PISA uses weights to increase or decrease the impact of individual students on overall results.</p>
<p>In the UK, students in Scotland had a higher likelihood of being sampled than those in England. With 4,763 students sampled in England and 3,257 sampled in Scotland; as a proportion, the Scottish population is too large. The school population of England (~9.1 million) is much larger than Scotland (~790 thousand), so we need to use weighting to decrease the impact of each Scottish student on the overall UK results, otherwise they would be over represented:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">group_by</span>(REGION) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb6-5"><a href="#cb6-5"></a>            <span class="at">W_FSTUWT_mean =</span> <span class="fu">mean</span>(W_FSTUWT)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="st">"n"</span>, <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="st">"W_FSTUWT_mean"</span>, <span class="at">decimals =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">cols_align</span>(<span class="at">columns =</span> <span class="st">"REGION"</span>, <span class="at">align=</span><span class="st">"left"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div id="mvfpnpaygg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mvfpnpaygg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mvfpnpaygg thead, #mvfpnpaygg tbody, #mvfpnpaygg tfoot, #mvfpnpaygg tr, #mvfpnpaygg td, #mvfpnpaygg th {
  border-style: none;
}

#mvfpnpaygg p {
  margin: 0;
  padding: 0;
}

#mvfpnpaygg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mvfpnpaygg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mvfpnpaygg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mvfpnpaygg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mvfpnpaygg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvfpnpaygg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvfpnpaygg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mvfpnpaygg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mvfpnpaygg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mvfpnpaygg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mvfpnpaygg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mvfpnpaygg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mvfpnpaygg .gt_spanner_row {
  border-bottom-style: hidden;
}

#mvfpnpaygg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mvfpnpaygg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mvfpnpaygg .gt_from_md > :first-child {
  margin-top: 0;
}

#mvfpnpaygg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mvfpnpaygg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mvfpnpaygg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mvfpnpaygg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mvfpnpaygg .gt_row_group_first td {
  border-top-width: 2px;
}

#mvfpnpaygg .gt_row_group_first th {
  border-top-width: 2px;
}

#mvfpnpaygg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvfpnpaygg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mvfpnpaygg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mvfpnpaygg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvfpnpaygg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvfpnpaygg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mvfpnpaygg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mvfpnpaygg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mvfpnpaygg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mvfpnpaygg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvfpnpaygg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvfpnpaygg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mvfpnpaygg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mvfpnpaygg .gt_left {
  text-align: left;
}

#mvfpnpaygg .gt_center {
  text-align: center;
}

#mvfpnpaygg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mvfpnpaygg .gt_font_normal {
  font-weight: normal;
}

#mvfpnpaygg .gt_font_bold {
  font-weight: bold;
}

#mvfpnpaygg .gt_font_italic {
  font-style: italic;
}

#mvfpnpaygg .gt_super {
  font-size: 65%;
}

#mvfpnpaygg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mvfpnpaygg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mvfpnpaygg .gt_indent_1 {
  text-indent: 5px;
}

#mvfpnpaygg .gt_indent_2 {
  text-indent: 10px;
}

#mvfpnpaygg .gt_indent_3 {
  text-indent: 15px;
}

#mvfpnpaygg .gt_indent_4 {
  text-indent: 20px;
}

#mvfpnpaygg .gt_indent_5 {
  text-indent: 25px;
}

#mvfpnpaygg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mvfpnpaygg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th id="REGION" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">REGION</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">n</th>
<th id="W_FSTUWT_mean" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">W_FSTUWT_mean</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="REGION">Great Britain: England</td>
<td class="gt_row gt_right" headers="n">4,763</td>
<td class="gt_row gt_right" headers="W_FSTUWT_mean">131.04</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="REGION">Great Britain: Northern Ireland</td>
<td class="gt_row gt_right" headers="n">2,384</td>
<td class="gt_row gt_right" headers="W_FSTUWT_mean">9.47</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="REGION">Great Britain: Wales</td>
<td class="gt_row gt_right" headers="n">2,568</td>
<td class="gt_row gt_right" headers="W_FSTUWT_mean">12.73</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="REGION">Great Britain: Scotland</td>
<td class="gt_row gt_right" headers="n">3,257</td>
<td class="gt_row gt_right" headers="W_FSTUWT_mean">15.91</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The ratio of students in England to students in Scotland is roughly 9,100,100 : 790,000 or 910 : 79, i.e.&nbsp;for every 910 English students, there should be 79 Scottish students; i.e.&nbsp;for every Scottish student there should be <em>11.5</em> English students. Applying the PISA students weights for students from England and Scotland we get:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>(<span class="dv">4763</span> <span class="sc">*</span> <span class="fl">131.04</span>) <span class="sc">/</span> (<span class="dv">3257</span> <span class="sc">*</span> <span class="fl">15.91</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.04471</code></pre>
</div>
</div>
<p>This is close to 11.5 but not quite the same as the population ratio. The reason might be that there are other factors that influence the student weighting, including situations where certain school types are under represented and other types over represented, for example there being more urban schools in the sample than in the population, this would then require students in rural schools to be given a greater weighting than students in urban schools. Allocating weights can be a complex process.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">group_by</span>(REGION, W_FSTUWT) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">mutate</span>(<span class="at">weight_label =</span> <span class="fu">ifelse</span>(W_FSTUWT <span class="sc">&gt;</span> <span class="dv">400</span>, <span class="st">"Heavyweight!"</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>W_FSTUWT, <span class="at">y=</span>n, <span class="at">colour =</span> W_FSTUWT <span class="sc">&lt;</span> <span class="dv">400</span>)) <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>W_FSTUWT<span class="dv">-35</span>, <span class="at">y=</span>n<span class="dv">-2</span>, <span class="at">label=</span>weight_label)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">facet_wrap</span>(REGION<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="A1-PISA_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can see that <em>all</em> students in England have a heavier weight attached to them than every student in Scotland, Wales and Northern Ireland. There is also a group of 9 students that have weightings of over 400, these are students that are very under represented in the sample. The weighting of these students is very high, and they will have a large impact on the overall results, potentially skewing results. For example, if the occupation of one of these student’s mothers (<code>OCOD3</code>) was as a butcher, then it would look like a lot of students in the UK had butchers as mothers, when in fact only one student in the sample did. This is a problem with weighting, and it is important to be aware of it when interpreting results.</p>
<p>So why are PISA sampling so many students from Scotland, Northern Ireland and Wales when each only forms a small part of the UK? By providing representative samples for each of these regions, it allows PISA to report for the UK as a whole and also to provide representative samples of students for each region of a country, allowing for the UK government (and us) to compare the performance of students under the different educational jurisdictions of the four nations.</p>
<p>So how do you use student weights in a calculation? Let’s look at some examples.</p>
<section id="numeric-fields" class="level4" data-number="4.2.1.1"><h4 data-number="4.2.1.1" class="anchored" data-anchor-id="numeric-fields">
<span class="header-section-number">4.2.1.1</span> Numeric fields</h4>
<p>We can find the mean poverty level of country, by looking at <code>HOMEPOS</code>. Calculating this without the weights gives us the following:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>df <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">summarise</span>(<span class="at">HOMEPOS_m =</span> <span class="fu">mean</span>(HOMEPOS, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb10-4"><a href="#cb10-4"></a>            <span class="at">HOMEPOS_md =</span> <span class="fu">median</span>(HOMEPOS, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">arrange</span>(HOMEPOS_m)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a>df</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 3
   CNT                          HOMEPOS_m HOMEPOS_md
   &lt;fct&gt;                            &lt;dbl&gt;      &lt;dbl&gt;
 1 Cambodia                      -2.41       -2.48  
 2 Morocco                       -1.77       -1.77  
 3 Philippines                   -1.75       -1.74  
 4 Indonesia                     -1.58       -1.63  
 5 El Salvador                   -1.57       -1.60  
 6 Guatemala                     -1.52       -1.58  
 7 Paraguay                      -1.52       -1.65  
 8 Palestinian Authority         -1.49       -1.43  
 9 Peru                          -1.40       -1.43  
10 Jordan                        -1.38       -1.36  
11 Panama                        -1.32       -1.31  
12 Mongolia                      -1.31       -1.36  
13 Dominican Republic            -1.31       -1.32  
14 Uzbekistan                    -1.30       -1.36  
15 Viet Nam                      -1.29       -1.30  
16 Colombia                      -1.26       -1.25  
17 Brazil                        -1.22       -1.30  
18 Thailand                      -1.17       -1.27  
19 Türkiye                       -1.08       -1.04  
20 Mexico                        -1.07       -1.12  
21 Baku (Azerbaijan)             -0.980      -1.02  
22 Costa Rica                    -0.979      -0.972 
23 Malaysia                      -0.908      -0.952 
24 Kazakhstan                    -0.870      -0.867 
25 Albania                       -0.859      -0.873 
26 Republic of Moldova           -0.846      -0.839 
27 Jamaica                       -0.834      -0.809 
28 Georgia                       -0.809      -0.817 
29 Argentina                     -0.806      -0.829 
30 Uruguay                       -0.747      -0.774 
31 Saudi Arabia                  -0.689      -0.767 
32 Kosovo                        -0.621      -0.633 
33 Ukrainian regions (18 of 27)  -0.550      -0.521 
34 North Macedonia               -0.490      -0.488 
35 Qatar                         -0.442      -0.477 
36 Romania                       -0.399      -0.357 
37 Chinese Taipei                -0.395      -0.407 
38 Chile                         -0.388      -0.396 
39 Bulgaria                      -0.368      -0.308 
40 Brunei Darussalam             -0.356      -0.411 
41 Montenegro                    -0.276      -0.269 
42 Greece                        -0.264      -0.268 
43 Macao (China)                 -0.253      -0.305 
44 Serbia                        -0.229      -0.201 
45 Japan                         -0.226      -0.210 
46 Hong Kong (China)             -0.198      -0.235 
47 Slovak Republic               -0.187      -0.125 
48 United Arab Emirates          -0.157      -0.208 
49 France                        -0.139      -0.0854
50 Croatia                       -0.117      -0.120 
51 Lithuania                     -0.0451     -0.0459
52 Latvia                         0.00480     0.0151
53 Israel                         0.0499      0.0954
54 Spain                          0.0739      0.104 
55 Portugal                       0.0755      0.0742
56 Poland                         0.0825      0.0847
57 Belgium                        0.0866      0.107 
58 Italy                          0.0887      0.109 
59 Hungary                        0.104       0.161 
60 United States                  0.115       0.0899
61 United Kingdom                 0.116       0.0947
62 Singapore                      0.124       0.0918
63 Germany                        0.149       0.188 
64 Finland                        0.162       0.217 
65 Estonia                        0.178       0.238 
66 Slovenia                       0.186       0.214 
67 Czech Republic                 0.194       0.239 
68 Switzerland                    0.221       0.260 
69 Denmark                        0.237       0.284 
70 Netherlands                    0.255       0.274 
71 Austria                        0.280       0.311 
72 Malta                          0.308       0.304 
73 Ireland                        0.318       0.319 
74 Sweden                         0.327       0.376 
75 Iceland                        0.346       0.383 
76 Canada                         0.348       0.366 
77 New Zealand                    0.367       0.401 
78 Korea                          0.371       0.418 
79 Australia                      0.483       0.520 
80 Norway                         0.547       0.616 </code></pre>
</div>
</div>
<p>Now we can adjust this code to apply weights - students in each country will have their <code>HOMEPOS</code> score multiplied by their weight, the mean of these weighted <code>HOMEPOS</code> values calculated and the result of this divided by the mean weights for each country.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">summarise</span>(<span class="at">HOMEPOS_m_weight =</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>              <span class="fu">mean</span>(HOMEPOS <span class="sc">*</span> W_FSTUWT, <span class="at">na.rm=</span><span class="cn">TRUE</span>) <span class="sc">/</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>              <span class="fu">mean</span>(W_FSTUWT)</span>
<span id="cb12-6"><a href="#cb12-6"></a>            ) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">arrange</span>(HOMEPOS_m_weight) <span class="sc">%&gt;%</span> </span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="fu">left_join</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">mutate</span>(<span class="at">weight_diff =</span> <span class="fu">abs</span>((HOMEPOS_m <span class="sc">-</span> HOMEPOS_m_weight) <span class="sc">/</span> HOMEPOS_m))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 5
   CNT                         HOMEPOS_m_weight HOMEPOS_m HOMEPOS_md weight_diff
   &lt;fct&gt;                                  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;
 1 Cambodia                            -2.34     -2.41       -2.48     0.0266   
 2 Philippines                         -1.75     -1.75       -1.74     0.000664 
 3 Morocco                             -1.74     -1.77       -1.77     0.0135   
 4 Indonesia                           -1.70     -1.58       -1.63     0.0738   
 5 El Salvador                         -1.63     -1.57       -1.60     0.0333   
 6 Paraguay                            -1.56     -1.52       -1.65     0.0259   
 7 Guatemala                           -1.54     -1.52       -1.58     0.00802  
 8 Palestinian Authority               -1.53     -1.49       -1.43     0.0270   
 9 Peru                                -1.44     -1.40       -1.43     0.0262   
10 Thailand                            -1.43     -1.17       -1.27     0.215    
11 Jordan                              -1.39     -1.38       -1.36     0.00733  
12 Colombia                            -1.37     -1.26       -1.25     0.0910   
13 Panama                              -1.32     -1.32       -1.31     0.00577  
14 Dominican Republic                  -1.31     -1.31       -1.32     0.00241  
15 Uzbekistan                          -1.31     -1.30       -1.36     0.00557  
16 Mongolia                            -1.31     -1.31       -1.36     0.00537  
17 Viet Nam                            -1.27     -1.29       -1.30     0.0128   
18 Brazil                              -1.23     -1.22       -1.30     0.0125   
19 Mexico                              -1.08     -1.07       -1.12     0.0102   
20 Türkiye                             -1.03     -1.08       -1.04     0.0437   
21 Baku (Azerbaijan)                   -1.02     -0.980      -1.02     0.0377   
22 Costa Rica                          -1.00     -0.979      -0.972    0.0242   
23 Kazakhstan                          -0.995    -0.870      -0.867    0.143    
24 Malaysia                            -0.925    -0.908      -0.952    0.0187   
25 Argentina                           -0.923    -0.806      -0.829    0.146    
26 Albania                             -0.866    -0.859      -0.873    0.00918  
27 Republic of Moldova                 -0.860    -0.846      -0.839    0.0165   
28 Georgia                             -0.832    -0.809      -0.817    0.0275   
29 Jamaica                             -0.786    -0.834      -0.809    0.0573   
30 Uruguay                             -0.768    -0.747      -0.774    0.0281   
31 Saudi Arabia                        -0.695    -0.689      -0.767    0.00840  
32 Kosovo                              -0.611    -0.621      -0.633    0.0169   
33 Chile                               -0.610    -0.388      -0.396    0.574    
34 Ukrainian regions (18 of 2…         -0.596    -0.550      -0.521    0.0854   
35 North Macedonia                     -0.500    -0.490      -0.488    0.0207   
36 Romania                             -0.478    -0.399      -0.357    0.199    
37 Qatar                               -0.470    -0.442      -0.477    0.0636   
38 Bulgaria                            -0.371    -0.368      -0.308    0.00632  
39 Brunei Darussalam                   -0.344    -0.356      -0.411    0.0329   
40 Chinese Taipei                      -0.332    -0.395      -0.407    0.161    
41 Greece                              -0.291    -0.264      -0.268    0.102    
42 Montenegro                          -0.283    -0.276      -0.269    0.0260   
43 Macao (China)                       -0.253    -0.253      -0.305    0.00187  
44 Slovak Republic                     -0.233    -0.187      -0.125    0.246    
45 Serbia                              -0.230    -0.229      -0.201    0.00396  
46 Japan                               -0.217    -0.226      -0.210    0.0393   
47 Hong Kong (China)                   -0.208    -0.198      -0.235    0.0522   
48 United Arab Emirates                -0.185    -0.157      -0.208    0.177    
49 Croatia                             -0.117    -0.117      -0.120    0.0000589
50 France                              -0.0718   -0.139      -0.0854   0.485    
51 Lithuania                           -0.0362   -0.0451     -0.0459   0.199    
52 Spain                                0.00557   0.0739      0.104    0.925    
53 Latvia                               0.00947   0.00480     0.0151   0.972    
54 Belgium                              0.0396    0.0866      0.107    0.543    
55 Portugal                             0.0499    0.0755      0.0742   0.339    
56 Hungary                              0.0502    0.104       0.161    0.518    
57 Poland                               0.0531    0.0825      0.0847   0.356    
58 Italy                                0.0738    0.0887      0.109    0.168    
59 Israel                               0.0757    0.0499      0.0954   0.517    
60 United Kingdom                       0.100     0.116       0.0947   0.135    
61 United States                        0.125     0.115       0.0899   0.0816   
62 Germany                              0.131     0.149       0.188    0.123    
63 Czech Republic                       0.132     0.194       0.239    0.321    
64 Singapore                            0.144     0.124       0.0918   0.166    
65 Estonia                              0.157     0.178       0.238    0.121    
66 Switzerland                          0.203     0.221       0.260    0.0802   
67 Slovenia                             0.231     0.186       0.214    0.239    
68 Austria                              0.248     0.280       0.311    0.112    
69 Finland                              0.260     0.162       0.217    0.602    
70 Netherlands                          0.265     0.255       0.274    0.0358   
71 Malta                                0.284     0.308       0.304    0.0798   
72 Ireland                              0.307     0.318       0.319    0.0345   
73 Sweden                               0.319     0.327       0.376    0.0227   
74 Iceland                              0.344     0.346       0.383    0.00730  
75 Korea                                0.357     0.371       0.418    0.0383   
76 New Zealand                          0.364     0.367       0.401    0.00932  
77 Denmark                              0.376     0.237       0.284    0.587    
78 Canada                               0.381     0.348       0.366    0.0933   
79 Australia                            0.478     0.483       0.520    0.0107   
80 Norway                               0.546     0.547       0.616    0.00202  </code></pre>
</div>
</div>
<p>The mean values <code>HOMEPOS_m</code> are very close to the non weighted mean results, but note that some of the countries have now swapped places, with Thailand now making the bottom ten countries for this measure. In a world where people take international PISA rankings very seriously, weighting can make a big difference!</p>
</section><section id="categorical-fields" class="level4" data-number="4.2.1.2"><h4 data-number="4.2.1.2" class="anchored" data-anchor-id="categorical-fields">
<span class="header-section-number">4.2.1.2</span> Categorical fields</h4>
<p>If you want to work out the weighting of categorical fields you can do the following: (WARNING: check what to do with REGION)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># create a symbol of the focus_name</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co"># allows you to adjust the focus of this code</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co"># by changing the value in focus_name</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>focus_name <span class="ot">&lt;-</span> <span class="st">"IC180Q01JA"</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>focus <span class="ot">&lt;-</span> <span class="fu">sym</span>(focus_name)</span>
<span id="cb14-6"><a href="#cb14-6"></a></span>
<span id="cb14-7"><a href="#cb14-7"></a>df_weight <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8"></a>  <span class="fu">group_by</span>(CNT, {{focus}}) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="fu">summarise</span>(<span class="at">foc_weight =</span> <span class="fu">sum</span>(W_FSTUWT)) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">group_by</span>(CNT, <span class="fu">is.na</span>({{focus}})) <span class="sc">%&gt;%</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">mutate</span>(<span class="at">foc_weight_pct =</span> foc_weight <span class="sc">/</span> <span class="fu">sum</span>(foc_weight))</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a>df_weight</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 288 × 5
# Groups:   CNT, is.na(IC180Q01JA) [132]
    CNT                 IC180Q01JA foc_weight `is.na(IC180Q01JA)` foc_weight_pct
    &lt;fct&gt;               &lt;fct&gt;           &lt;dbl&gt; &lt;lgl&gt;                        &lt;dbl&gt;
  1 Albania             Strongly …     2507.  FALSE                       0.159 
  2 Albania             Disagree       5570.  FALSE                       0.354 
  3 Albania             Agree          5812.  FALSE                       0.369 
  4 Albania             Strongly …     1859.  FALSE                       0.118 
  5 Albania             &lt;NA&gt;          12678.  TRUE                        1     
  6 United Arab Emirat… &lt;NA&gt;          60765.  TRUE                        1     
  7 Argentina           Strongly …    45273.  FALSE                       0.145 
  8 Argentina           Disagree     117827.  FALSE                       0.377 
  9 Argentina           Agree        127605.  FALSE                       0.408 
 10 Argentina           Strongly …    21941.  FALSE                       0.0702
 11 Argentina           &lt;NA&gt;         283655.  TRUE                        1     
 12 Australia           Strongly …    10923.  FALSE                       0.0474
 13 Australia           Disagree      98093.  FALSE                       0.426 
 14 Australia           Agree        114875.  FALSE                       0.499 
 15 Australia           Strongly …     6476.  FALSE                       0.0281
 16 Australia           &lt;NA&gt;          34828.  TRUE                        1     
 17 Austria             Strongly …    10459.  FALSE                       0.163 
 18 Austria             Disagree      33042.  FALSE                       0.514 
 19 Austria             Agree         19061.  FALSE                       0.296 
 20 Austria             Strongly …     1778.  FALSE                       0.0276
 21 Austria             &lt;NA&gt;          11813.  TRUE                        1     
 22 Belgium             Strongly …    10347.  FALSE                       0.104 
 23 Belgium             Disagree      57077.  FALSE                       0.575 
 24 Belgium             Agree         29399.  FALSE                       0.296 
 25 Belgium             Strongly …     2515.  FALSE                       0.0253
 26 Belgium             &lt;NA&gt;          29303.  TRUE                        1     
 27 Bulgaria            Strongly …     6090.  FALSE                       0.177 
 28 Bulgaria            Disagree      14075.  FALSE                       0.409 
 29 Bulgaria            Agree         11369.  FALSE                       0.330 
 30 Bulgaria            Strongly …     2905.  FALSE                       0.0844
 31 Bulgaria            &lt;NA&gt;          18983.  TRUE                        1     
 32 Brazil              Strongly …   235724.  FALSE                       0.171 
 33 Brazil              Disagree     668596.  FALSE                       0.485 
 34 Brazil              Agree        387147.  FALSE                       0.281 
 35 Brazil              Strongly …    87035.  FALSE                       0.0631
 36 Brazil              &lt;NA&gt;         884469.  TRUE                        1     
 37 Brunei Darussalam   Strongly …      368.  FALSE                       0.0652
 38 Brunei Darussalam   Disagree       2919.  FALSE                       0.517 
 39 Brunei Darussalam   Agree          2203.  FALSE                       0.390 
 40 Brunei Darussalam   Strongly …      153.  FALSE                       0.0271
 41 Brunei Darussalam   &lt;NA&gt;            337.  TRUE                        1     
 42 Canada              &lt;NA&gt;         357911.  TRUE                        1     
 43 Switzerland         Strongly …     6965.  FALSE                       0.109 
 44 Switzerland         Disagree      32294.  FALSE                       0.507 
 45 Switzerland         Agree         22844.  FALSE                       0.358 
 46 Switzerland         Strongly …     1642.  FALSE                       0.0258
 47 Switzerland         &lt;NA&gt;          11951.  TRUE                        1     
 48 Chile               Strongly …    16894.  FALSE                       0.114 
 49 Chile               Disagree      68429.  FALSE                       0.463 
 50 Chile               Agree         54921.  FALSE                       0.371 
 51 Chile               Strongly …     7627.  FALSE                       0.0516
 52 Chile               &lt;NA&gt;          66238.  TRUE                        1     
 53 Colombia            &lt;NA&gt;         586683.  TRUE                        1     
 54 Costa Rica          Strongly …     7307.  FALSE                       0.157 
 55 Costa Rica          Disagree      24205.  FALSE                       0.519 
 56 Costa Rica          Agree         13593.  FALSE                       0.291 
 57 Costa Rica          Strongly …     1529.  FALSE                       0.0328
 58 Costa Rica          &lt;NA&gt;          10616.  TRUE                        1     
 59 Czech Republic      Strongly …     9050.  FALSE                       0.107 
 60 Czech Republic      Disagree      48233.  FALSE                       0.570 
 61 Czech Republic      Agree         24759.  FALSE                       0.293 
 62 Czech Republic      Strongly …     2576.  FALSE                       0.0304
 63 Czech Republic      &lt;NA&gt;          15648.  TRUE                        1     
 64 Germany             Strongly …    58565.  FALSE                       0.115 
 65 Germany             Disagree     260882.  FALSE                       0.514 
 66 Germany             Agree        176343.  FALSE                       0.348 
 67 Germany             Strongly …    11552.  FALSE                       0.0228
 68 Germany             &lt;NA&gt;         174057.  TRUE                        1     
 69 Denmark             Strongly …     1470.  FALSE                       0.0331
 70 Denmark             Disagree      14276.  FALSE                       0.321 
 71 Denmark             Agree         27339.  FALSE                       0.616 
 72 Denmark             Strongly …     1323.  FALSE                       0.0298
 73 Denmark             &lt;NA&gt;          12502.  TRUE                        1     
 74 Dominican Republic  Strongly …    17636.  FALSE                       0.220 
 75 Dominican Republic  Disagree      28924.  FALSE                       0.360 
 76 Dominican Republic  Agree         26915.  FALSE                       0.335 
 77 Dominican Republic  Strongly …     6825.  FALSE                       0.0850
 78 Dominican Republic  &lt;NA&gt;          41576.  TRUE                        1     
 79 Spain               Strongly …    45950.  FALSE                       0.116 
 80 Spain               Disagree     201512.  FALSE                       0.511 
 81 Spain               Agree        135443.  FALSE                       0.343 
 82 Spain               Strongly …    11756.  FALSE                       0.0298
 83 Spain               &lt;NA&gt;          64368.  TRUE                        1     
 84 Estonia             Strongly …      783.  FALSE                       0.0660
 85 Estonia             Disagree       5722.  FALSE                       0.482 
 86 Estonia             Agree          5098.  FALSE                       0.429 
 87 Estonia             Strongly …      269.  FALSE                       0.0226
 88 Estonia             &lt;NA&gt;           1473.  TRUE                        1     
 89 Finland             Strongly …     2297.  FALSE                       0.0481
 90 Finland             Disagree      20436.  FALSE                       0.428 
 91 Finland             Agree         23501.  FALSE                       0.492 
 92 Finland             Strongly …     1485.  FALSE                       0.0311
 93 Finland             &lt;NA&gt;          11236.  TRUE                        1     
 94 France              &lt;NA&gt;         781286.  TRUE                        1     
 95 United Kingdom      Strongly …    40671.  FALSE                       0.0811
 96 United Kingdom      Disagree     264813.  FALSE                       0.528 
 97 United Kingdom      Agree        186435.  FALSE                       0.372 
 98 United Kingdom      Strongly …     9545.  FALSE                       0.0190
 99 United Kingdom      &lt;NA&gt;         229760.  TRUE                        1     
100 Georgia             Strongly …     2740.  FALSE                       0.119 
101 Georgia             Disagree       7301.  FALSE                       0.318 
102 Georgia             Agree         10901.  FALSE                       0.475 
103 Georgia             Strongly …     2023.  FALSE                       0.0881
104 Georgia             &lt;NA&gt;          17450.  TRUE                        1     
105 Greece              Strongly …    18800.  FALSE                       0.223 
106 Greece              Disagree      49073.  FALSE                       0.582 
107 Greece              Agree         13515.  FALSE                       0.160 
108 Greece              Strongly …     2966.  FALSE                       0.0352
109 Greece              &lt;NA&gt;          13732.  TRUE                        1     
110 Guatemala           &lt;NA&gt;         168484.  TRUE                        1     
111 Hong Kong (China)   Strongly …     1740.  FALSE                       0.0397
112 Hong Kong (China)   Disagree      20067.  FALSE                       0.457 
113 Hong Kong (China)   Agree         20841.  FALSE                       0.475 
114 Hong Kong (China)   Strongly …     1221.  FALSE                       0.0278
115 Hong Kong (China)   &lt;NA&gt;           4376.  TRUE                        1     
116 Croatia             Strongly …     4086.  FALSE                       0.131 
117 Croatia             Disagree      17859.  FALSE                       0.573 
118 Croatia             Agree          8540.  FALSE                       0.274 
119 Croatia             Strongly …      680.  FALSE                       0.0218
120 Croatia             &lt;NA&gt;           3868.  TRUE                        1     
121 Hungary             Strongly …     7778.  FALSE                       0.102 
122 Hungary             Disagree      43124.  FALSE                       0.567 
123 Hungary             Agree         22753.  FALSE                       0.299 
124 Hungary             Strongly …     2363.  FALSE                       0.0311
125 Hungary             &lt;NA&gt;          11972.  TRUE                        1     
126 Indonesia           &lt;NA&gt;        3790846.  TRUE                        1     
127 Ireland             Strongly …     3283.  FALSE                       0.0546
128 Ireland             Disagree      34848.  FALSE                       0.580 
129 Ireland             Agree         21354.  FALSE                       0.355 
130 Ireland             Strongly …      630.  FALSE                       0.0105
131 Ireland             &lt;NA&gt;           5382.  TRUE                        1     
132 Iceland             Strongly …      216.  FALSE                       0.0650
133 Iceland             Disagree       1395.  FALSE                       0.420 
134 Iceland             Agree          1600.  FALSE                       0.482 
135 Iceland             Strongly …      108.  FALSE                       0.0324
136 Iceland             &lt;NA&gt;           1034.  TRUE                        1     
137 Israel              Strongly …    11806.  FALSE                       0.136 
138 Israel              Disagree      36260.  FALSE                       0.418 
139 Israel              Agree         35247.  FALSE                       0.406 
140 Israel              Strongly …     3519.  FALSE                       0.0405
141 Israel              &lt;NA&gt;          45644.  TRUE                        1     
142 Italy               Strongly …    52217.  FALSE                       0.119 
143 Italy               Disagree     246401.  FALSE                       0.561 
144 Italy               Agree        126434.  FALSE                       0.288 
145 Italy               Strongly …    13782.  FALSE                       0.0314
146 Italy               &lt;NA&gt;          57428.  TRUE                        1     
147 Jamaica             &lt;NA&gt;          25495.  TRUE                        1     
148 Jordan              Strongly …    23035.  FALSE                       0.246 
149 Jordan              Disagree      36245.  FALSE                       0.386 
150 Jordan              Agree         26399.  FALSE                       0.281 
151 Jordan              Strongly …     8106.  FALSE                       0.0864
152 Jordan              &lt;NA&gt;          50484.  TRUE                        1     
153 Japan               Strongly …   117347.  FALSE                       0.116 
154 Japan               Disagree     562095.  FALSE                       0.558 
155 Japan               Agree        305186.  FALSE                       0.303 
156 Japan               Strongly …    23135.  FALSE                       0.0230
157 Japan               &lt;NA&gt;          13606.  TRUE                        1     
158 Kazakhstan          Strongly …    24356.  FALSE                       0.0947
159 Kazakhstan          Disagree     110502.  FALSE                       0.430 
160 Kazakhstan          Agree        111368.  FALSE                       0.433 
161 Kazakhstan          Strongly …    10892.  FALSE                       0.0424
162 Kazakhstan          &lt;NA&gt;          15328.  TRUE                        1     
163 Cambodia            &lt;NA&gt;         126409.  TRUE                        1     
164 Korea               Strongly …    38662.  FALSE                       0.0961
165 Korea               Disagree     158940.  FALSE                       0.395 
166 Korea               Agree        194438.  FALSE                       0.483 
167 Korea               Strongly …    10124.  FALSE                       0.0252
168 Korea               &lt;NA&gt;          25848.  TRUE                        1     
169 Kosovo              &lt;NA&gt;          21045.  TRUE                        1     
170 Lithuania           Strongly …     2183.  FALSE                       0.101 
171 Lithuania           Disagree      11235.  FALSE                       0.519 
172 Lithuania           Agree          7687.  FALSE                       0.355 
173 Lithuania           Strongly …      527.  FALSE                       0.0244
174 Lithuania           &lt;NA&gt;           2618.  TRUE                        1     
175 Latvia              Strongly …     1010.  FALSE                       0.0674
176 Latvia              Disagree       7011.  FALSE                       0.468 
177 Latvia              Agree          6569.  FALSE                       0.438 
178 Latvia              Strongly …      394.  FALSE                       0.0263
179 Latvia              &lt;NA&gt;           1848.  TRUE                        1     
180 Macao (China)       Strongly …      187.  FALSE                       0.0428
181 Macao (China)       Disagree       2409.  FALSE                       0.552 
182 Macao (China)       Agree          1684.  FALSE                       0.386 
183 Macao (China)       Strongly …       81.7 FALSE                       0.0187
184 Macao (China)       &lt;NA&gt;             61.1 TRUE                        1     
185 Morocco             Strongly …    98434.  FALSE                       0.269 
186 Morocco             Disagree     153812.  FALSE                       0.420 
187 Morocco             Agree         98009.  FALSE                       0.268 
188 Morocco             Strongly …    15983.  FALSE                       0.0436
189 Morocco             &lt;NA&gt;          88748.  TRUE                        1     
190 Republic of Moldova &lt;NA&gt;          28879.  TRUE                        1     
191 Mexico              &lt;NA&gt;        1393727.  TRUE                        1     
192 North Macedonia     &lt;NA&gt;          16548.  TRUE                        1     
193 Malta               Strongly …      368.  FALSE                       0.118 
194 Malta               Disagree       1523.  FALSE                       0.489 
195 Malta               Agree          1095.  FALSE                       0.352 
196 Malta               Strongly …      128.  FALSE                       0.0409
197 Malta               &lt;NA&gt;            841.  TRUE                        1     
198 Montenegro          &lt;NA&gt;           6340.  TRUE                        1     
199 Mongolia            &lt;NA&gt;          40828.  TRUE                        1     
200 Malaysia            Strongly …    32108.  FALSE                       0.0894
201 Malaysia            Disagree     176408.  FALSE                       0.491 
202 Malaysia            Agree        138331.  FALSE                       0.385 
203 Malaysia            Strongly …    12108.  FALSE                       0.0337
204 Malaysia            &lt;NA&gt;          31493.  TRUE                        1     
205 Netherlands         &lt;NA&gt;         155987.  TRUE                        1     
206 Norway              &lt;NA&gt;          58970.  TRUE                        1     
207 New Zealand         &lt;NA&gt;          56382.  TRUE                        1     
208 Panama              Strongly …     5123.  FALSE                       0.194 
209 Panama              Disagree      10773.  FALSE                       0.407 
210 Panama              Agree          8530.  FALSE                       0.323 
211 Panama              Strongly …     2015.  FALSE                       0.0762
212 Panama              &lt;NA&gt;          15649.  TRUE                        1     
213 Peru                &lt;NA&gt;         499075.  TRUE                        1     
214 Philippines         &lt;NA&gt;        1782896.  TRUE                        1     
215 Poland              Strongly …    33869.  FALSE                       0.118 
216 Poland              Disagree     158147.  FALSE                       0.553 
217 Poland              Agree         83075.  FALSE                       0.291 
218 Poland              Strongly …    10811.  FALSE                       0.0378
219 Poland              &lt;NA&gt;          55659.  TRUE                        1     
220 Portugal            &lt;NA&gt;          96607.  TRUE                        1     
221 Paraguay            &lt;NA&gt;          81004.  TRUE                        1     
222 Palestinian Author… &lt;NA&gt;          88383.  TRUE                        1     
223 Qatar               &lt;NA&gt;          18348.  TRUE                        1     
224 Baku (Azerbaijan)   &lt;NA&gt;          30529.  TRUE                        1     
225 Ukrainian regions … Strongly …    13356.  FALSE                       0.108 
226 Ukrainian regions … Disagree      61379.  FALSE                       0.497 
227 Ukrainian regions … Agree         43666.  FALSE                       0.353 
228 Ukrainian regions … Strongly …     5137.  FALSE                       0.0416
229 Ukrainian regions … &lt;NA&gt;          42054.  TRUE                        1     
230 Romania             Strongly …    14905.  FALSE                       0.107 
231 Romania             Disagree      57042.  FALSE                       0.410 
232 Romania             Agree         59642.  FALSE                       0.428 
233 Romania             Strongly …     7665.  FALSE                       0.0550
234 Romania             &lt;NA&gt;          22765.  TRUE                        1     
235 Saudi Arabia        Strongly …    46886.  FALSE                       0.210 
236 Saudi Arabia        Disagree      87098.  FALSE                       0.389 
237 Saudi Arabia        Agree         70819.  FALSE                       0.316 
238 Saudi Arabia        Strongly …    18977.  FALSE                       0.0848
239 Saudi Arabia        &lt;NA&gt;          93671.  TRUE                        1     
240 Singapore           Strongly …     2342.  FALSE                       0.0575
241 Singapore           Disagree      19881.  FALSE                       0.488 
242 Singapore           Agree         17531.  FALSE                       0.430 
243 Singapore           Strongly …      970.  FALSE                       0.0238
244 Singapore           &lt;NA&gt;           1233.  TRUE                        1     
245 El Salvador         &lt;NA&gt;          68170.  TRUE                        1     
246 Serbia              &lt;NA&gt;          59250.  TRUE                        1     
247 Slovak Republic     Strongly …     5846.  FALSE                       0.148 
248 Slovak Republic     Disagree      19984.  FALSE                       0.507 
249 Slovak Republic     Agree         11868.  FALSE                       0.301 
250 Slovak Republic     Strongly …     1680.  FALSE                       0.0427
251 Slovak Republic     &lt;NA&gt;           8074.  TRUE                        1     
252 Slovenia            Strongly …     1788.  FALSE                       0.105 
253 Slovenia            Disagree       9389.  FALSE                       0.551 
254 Slovenia            Agree          5438.  FALSE                       0.319 
255 Slovenia            Strongly …      437.  FALSE                       0.0256
256 Slovenia            &lt;NA&gt;           1798.  TRUE                        1     
257 Sweden              Strongly …     6027.  FALSE                       0.0678
258 Sweden              Disagree      38935.  FALSE                       0.438 
259 Sweden              Agree         41143.  FALSE                       0.463 
260 Sweden              Strongly …     2797.  FALSE                       0.0315
261 Sweden              &lt;NA&gt;          19598.  TRUE                        1     
262 Chinese Taipei      Strongly …    15169.  FALSE                       0.0824
263 Chinese Taipei      Disagree     112090.  FALSE                       0.609 
264 Chinese Taipei      Agree         53582.  FALSE                       0.291 
265 Chinese Taipei      Strongly …     3232.  FALSE                       0.0176
266 Chinese Taipei      &lt;NA&gt;           6714.  TRUE                        1     
267 Thailand            Strongly …    47775.  FALSE                       0.0839
268 Thailand            Disagree     217575.  FALSE                       0.382 
269 Thailand            Agree        278841.  FALSE                       0.490 
270 Thailand            Strongly …    25345.  FALSE                       0.0445
271 Thailand            &lt;NA&gt;          35037.  TRUE                        1     
272 Türkiye             Strongly …   146806.  FALSE                       0.164 
273 Türkiye             Disagree     426210.  FALSE                       0.476 
274 Türkiye             Agree        283227.  FALSE                       0.316 
275 Türkiye             Strongly …    39236.  FALSE                       0.0438
276 Türkiye             &lt;NA&gt;          37923.  TRUE                        1     
277 Uruguay             Strongly …     2682.  FALSE                       0.114 
278 Uruguay             Disagree       9705.  FALSE                       0.411 
279 Uruguay             Agree         10061.  FALSE                       0.426 
280 Uruguay             Strongly …     1167.  FALSE                       0.0494
281 Uruguay             &lt;NA&gt;          17162.  TRUE                        1     
282 United States       Strongly …   192313.  FALSE                       0.0618
283 United States       Disagree    1515610.  FALSE                       0.487 
284 United States       Agree       1297432.  FALSE                       0.417 
285 United States       Strongly …   104544.  FALSE                       0.0336
286 United States       &lt;NA&gt;         551429.  TRUE                        1     
287 Uzbekistan          &lt;NA&gt;         482059.  TRUE                        1     
288 Viet Nam            &lt;NA&gt;         939459.  TRUE                        1     </code></pre>
</div>
</div>
</section><section id="t-tests" class="level4" data-number="4.2.1.3"><h4 data-number="4.2.1.3" class="anchored" data-anchor-id="t-tests">
<span class="header-section-number">4.2.1.3</span> T-tests</h4>
<p>When performing t-tests, you can use the <code>wtd.t.test()</code> function from the <code>weights</code> package. This function allows you to perform a t-test with weights applied to the data. The <code>wtd.t.test()</code> function takes the following arguments:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">library</span>(weights)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">wtd.t.test</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="correlations" class="level4" data-number="4.2.1.4"><h4 data-number="4.2.1.4" class="anchored" data-anchor-id="correlations">
<span class="header-section-number">4.2.1.4</span> Correlations</h4>
<p>If you’re looking to run a correlation test you’re going to need to adjust the number of observations depending on the weight of each student entry. For example if a student had a <code>W_FSTUWT</code> of 5, then you need to create 5 instances of that student, using the <code>rep</code> command, if another student had a weight of 105, you’d create 105 instances of that student; and so on. You then need to run the <code>cor</code> command on the enlarged data set. Note that we use the round command in the rep function as we need whole numbers for the weightings, this will lead to some potential, albeit very small, error in the final models.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>cor_data <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">select</span>(PV1MATH, ESCS, W_FSTUWT) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co"># create enlarged data set </span></span>
<span id="cb17-7"><a href="#cb17-7"></a>pv1math_weighted <span class="ot">&lt;-</span> <span class="fu">rep</span>(cor_data<span class="sc">$</span>PV1MATH, </span>
<span id="cb17-8"><a href="#cb17-8"></a>                  <span class="at">times =</span> <span class="fu">round</span>(cor_data<span class="sc">$</span>W_FSTUWT, <span class="dv">0</span>))</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a>escs_weighted <span class="ot">&lt;-</span> <span class="fu">rep</span>(cor_data<span class="sc">$</span>ESCS, </span>
<span id="cb17-11"><a href="#cb17-11"></a>                  <span class="at">times =</span> <span class="fu">round</span>(cor_data<span class="sc">$</span>W_FSTUWT, <span class="dv">0</span>))</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co"># run correlation test using weighted data</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="fu">cor</span>(pv1math_weighted, escs_weighted)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.328924</code></pre>
</div>
</div>
<p>If we run the correlation test on the original data set you can see that the correlation co-efficient is marginally different. Again, this might make the difference between something being statistically important or not.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">cor</span>(cor_data<span class="sc">$</span>PV1MATH, cor_data<span class="sc">$</span>ESCS)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3573955</code></pre>
</div>
</div>
<p>If you do lots of correlations you could build your own function to perform this weighted test. Using the <code>scale_weight</code> parameter allows us to scale up the weighting value, so we can alleviate the issues of losing accuracy when rounding. For example if a weight for a student was 3.49 this would have been rounded down to 3, to fix this we could set <code>scale_weight</code> to 100, which would adjust the weight to 349 and would dissipate most of the rounding error.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>corr_weighted <span class="ot">&lt;-</span> <span class="cf">function</span>(data, fld1, fld2, </span>
<span id="cb21-2"><a href="#cb21-2"></a>                          <span class="at">fldweight =</span> <span class="st">"W_FSTUWT"</span>, </span>
<span id="cb21-3"><a href="#cb21-3"></a>                          <span class="at">scale_weight =</span> <span class="dv">1</span>){</span>
<span id="cb21-4"><a href="#cb21-4"></a>  cor_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(fld1, fld2, fldweight))) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="co"># create enlarged data set </span></span>
<span id="cb21-9"><a href="#cb21-9"></a>  fld1_weighted <span class="ot">&lt;-</span> <span class="fu">rep</span>(cor_data[[fld1]], </span>
<span id="cb21-10"><a href="#cb21-10"></a>                    <span class="at">times =</span> <span class="fu">round</span>(cor_data[[fldweight]] <span class="sc">*</span> scale_weight, <span class="dv">0</span>))</span>
<span id="cb21-11"><a href="#cb21-11"></a></span>
<span id="cb21-12"><a href="#cb21-12"></a>  fld2_weighted <span class="ot">&lt;-</span> <span class="fu">rep</span>(cor_data[[fld2]], </span>
<span id="cb21-13"><a href="#cb21-13"></a>                   <span class="at">times =</span> <span class="fu">round</span>(cor_data[[fldweight]] <span class="sc">*</span> scale_weight, <span class="dv">0</span>))</span>
<span id="cb21-14"><a href="#cb21-14"></a></span>
<span id="cb21-15"><a href="#cb21-15"></a>  <span class="co"># run correlation test using weighted data</span></span>
<span id="cb21-16"><a href="#cb21-16"></a>  <span class="fu">cor</span>(fld1_weighted, fld2_weighted)</span>
<span id="cb21-17"><a href="#cb21-17"></a>}</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="fu">corr_weighted</span>(<span class="at">data =</span> PISA_2022, </span>
<span id="cb21-21"><a href="#cb21-21"></a>              <span class="at">fld1 =</span> <span class="st">"PV1SCIE"</span>, </span>
<span id="cb21-22"><a href="#cb21-22"></a>              <span class="at">fld2 =</span> <span class="st">"HOMEPOS"</span>,</span>
<span id="cb21-23"><a href="#cb21-23"></a>              <span class="at">fldweight =</span> <span class="st">"W_FSTUWT"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5189734</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># we can just focus on females in France</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">corr_weighted</span>(<span class="at">data =</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"France"</span>, ST004D01T <span class="sc">==</span> <span class="st">"Female"</span>), </span>
<span id="cb23-3"><a href="#cb23-3"></a>              <span class="at">fld1 =</span> <span class="st">"PV1SCIE"</span>, </span>
<span id="cb23-4"><a href="#cb23-4"></a>              <span class="at">fld2 =</span> <span class="st">"PV1MATH"</span>,</span>
<span id="cb23-5"><a href="#cb23-5"></a>              <span class="at">fldweight =</span> <span class="st">"W_FSTUWT"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8852219</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># we can also omit the fldweight as the name is given</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co"># by default in the function definition.</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co"># by setting scale_weight to 100 we can get a slightly</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co"># more accurate outcome</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="fu">corr_weighted</span>(<span class="at">data =</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"France"</span>, ST004D01T <span class="sc">==</span> <span class="st">"Female"</span>), </span>
<span id="cb25-6"><a href="#cb25-6"></a>              <span class="at">fld1 =</span> <span class="st">"PV1SCIE"</span>, </span>
<span id="cb25-7"><a href="#cb25-7"></a>              <span class="at">fld2 =</span> <span class="st">"PV1MATH"</span>,</span>
<span id="cb25-8"><a href="#cb25-8"></a>              <span class="at">scale_weight =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8852398</code></pre>
</div>
</div>
</section><section id="linear-models" class="level4" data-number="4.2.1.5"><h4 data-number="4.2.1.5" class="anchored" data-anchor-id="linear-models">
<span class="header-section-number">4.2.1.5</span> Linear models</h4>
<p>When performing linear models, you can use the inbuilt <code>weights</code> argument in the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function. This is a simple way of applying weights to your model. The <code>weights</code> argument takes a vector of weights (in our case the column <code>W_FSTUWT</code>), which should be the same length as the number of rows in your data set.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">lm</span>(PV1MATH <span class="sc">~</span> PV1READ <span class="sc">+</span> ST004D01T,</span>
<span id="cb27-2"><a href="#cb27-2"></a>   <span class="at">data =</span> PISA_2022,</span>
<span id="cb27-3"><a href="#cb27-3"></a>   <span class="at">weights =</span> PISA_2022<span class="sc">$</span>W_FSTUWT) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href="#cb27-4"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1MATH ~ PV1READ + ST004D01T, data = PISA_2022, 
    weights = PISA_2022$W_FSTUWT)

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-6291.5   -92.9    25.2   151.5  8580.0 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.561e+01  2.817e-01   303.9   &lt;2e-16 ***
PV1READ       7.610e-01  6.021e-04  1263.8   &lt;2e-16 ***
ST004D01TMale 2.161e+01  1.341e-01   161.2   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 354.7 on 613662 degrees of freedom
  (79 observations deleted due to missingness)
Multiple R-squared:  0.7227,    Adjusted R-squared:  0.7227 
F-statistic: 7.996e+05 on 2 and 613662 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">lm</span>(PV1MATH <span class="sc">~</span> PV1READ <span class="sc">+</span> ST004D01T,</span>
<span id="cb29-2"><a href="#cb29-2"></a>   <span class="at">data =</span> PISA_2022) <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1MATH ~ PV1READ + ST004D01T, data = PISA_2022)

Residuals:
     Min       1Q   Median       3Q      Max 
-289.474  -37.253   -2.099   35.295  309.126 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.363e+01  3.086e-01   271.0   &lt;2e-16 ***
PV1READ       7.863e-01  6.478e-04  1213.8   &lt;2e-16 ***
ST004D01TMale 2.528e+01  1.419e-01   178.2   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 55.2 on 613662 degrees of freedom
  (79 observations deleted due to missingness)
Multiple R-squared:  0.7062,    Adjusted R-squared:  0.7062 
F-statistic: 7.375e+05 on 2 and 613662 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>If you are performing a linear regression on a subset of the data, you can use the <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> function to select the rows you want to include in your analysis. The <code>weights</code> argument will still work as long as the weights vector refers to the rows you have in your filtered data set. For example, if you want to run a linear regression on the UK data only, you can do the following:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">lm</span>(PV1MATH <span class="sc">~</span> PV1READ <span class="sc">+</span> ST004D01T,</span>
<span id="cb31-2"><a href="#cb31-2"></a>   <span class="at">data =</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>),</span>
<span id="cb31-3"><a href="#cb31-3"></a>   <span class="at">weights =</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(W_FSTUWT)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1MATH ~ PV1READ + ST004D01T, data = PISA_2022 %&gt;% 
    filter(CNT == "United Kingdom"), weights = PISA_2022 %&gt;% 
    filter(CNT == "United Kingdom") %&gt;% pull(W_FSTUWT))

Weighted Residuals:
    Min      1Q  Median      3Q     Max 
-3198.7  -199.7   -16.5   164.9  2480.0 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   109.31499    2.42600   45.06   &lt;2e-16 ***
PV1READ         0.73921    0.00462  160.02   &lt;2e-16 ***
ST004D01TMale  28.26683    0.97996   28.84   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 417.6 on 12969 degrees of freedom
Multiple R-squared:  0.6661,    Adjusted R-squared:  0.666 
F-statistic: 1.293e+04 on 2 and 12969 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>If we run the same model without the weights, we get a slightly different result.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">lm</span>(PV1MATH <span class="sc">~</span> PV1READ <span class="sc">+</span> ST004D01T,</span>
<span id="cb33-2"><a href="#cb33-2"></a>   PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"United Kingdom"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">summary</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PV1MATH ~ PV1READ + ST004D01T, data = PISA_2022 %&gt;% 
    filter(CNT == "United Kingdom"))

Residuals:
     Min       1Q   Median       3Q      Max 
-229.768  -36.901    0.317   36.857  243.155 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.083e+02  2.445e+00   44.27   &lt;2e-16 ***
PV1READ       7.344e-01  4.685e-03  156.75   &lt;2e-16 ***
ST004D01TMale 2.737e+01  9.829e-01   27.84   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 55.75 on 12969 degrees of freedom
Multiple R-squared:  0.6563,    Adjusted R-squared:  0.6563 
F-statistic: 1.238e+04 on 2 and 12969 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>By default, above, the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function is treating all observations equally, regardless of their weights. Whilst the two models look very similar, a slight change in a p-value, or a change in the coefficient of a variable can have a big impact on the interpretation of a model.</p>
</section></section><section id="senate-weights" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="senate-weights">
<span class="header-section-number">4.2.2</span> Senate weights</h3>
<p>The data set contains another weighting variable, the <em>senate weight</em> [<code>COL_ID</code>]. To ensure that countries make equal contributions to regression models when they have different response rates, senate weights are published <span class="citation" data-cites="jerrim2017weight">(<a href="#ref-jerrim2017weight" role="doc-biblioref">Jerrim et al. 2017</a>)</span>. Senate weights renormalise the weights within each country so that the total for a country sums to a constant value, giving each country the same weight in an overall analysis <span class="citation" data-cites="rijmen2011hierarchical">(<a href="#ref-rijmen2011hierarchical" role="doc-biblioref">Rijmen 2011</a>)</span>.</p>
</section></section><section id="how-do-i-use-the-plausible-values-and-weights-correctly" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="how-do-i-use-the-plausible-values-and-weights-correctly">
<span class="header-section-number">4.3</span> How do I use the plausible values and weights correctly?</h2>
<p>To simplify our teaching, we focus on using a single PV value, <code>PV1___</code> in our calculations. This is not the recommended use, but simplifies our introduction to the PISA data. Here we set out how to perform a more complete analysis.</p>
<p>The first step in analysis is to apply the weights. In the code below, we select the needed columns, country, the student weight column (<code>W_FSTUWT</code>) and the ten PV values (in this case for math). The <code>mutate(across(...</code> line multiples each of the ten PV values by the value in <code>W_FSTUWT</code>, the student weight, and adds new columns with <code>_weighted</code> appended.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">select</span>(CNT, W_FSTUWT, PV1MATH<span class="sc">:</span>PV10MATH) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(PV1MATH<span class="sc">:</span>PV10MATH, <span class="sc">~</span> .x <span class="sc">*</span> W_FSTUWT, <span class="at">.names =</span> <span class="st">"{.col}_weighted"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Next we <code>group_by(CNT)</code> and summarise to get a <code>total_weight</code> for each country, by adding all the individual student weights (<code>W_FSTUWT</code>). To get a mean PV1, PV2, etc score for each country, we then sum all the weighted PV1 scores and divide by the total weight, and do the same for PV2, Pv3 etc. These are given the names <code>PV1MATH_weighted_mean</code>, <code>PV2MATH_weighted_mean</code>, etc.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">select</span>(CNT, W_FSTUWT, PV1MATH<span class="sc">:</span>PV10MATH) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(PV1MATH<span class="sc">:</span>PV10MATH, <span class="sc">~</span> .x <span class="sc">*</span> W_FSTUWT, <span class="at">.names =</span> <span class="st">"{.col}_weighted"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-6"><a href="#cb36-6"></a>    <span class="at">total_weight =</span> <span class="fu">sum</span>(W_FSTUWT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-7"><a href="#cb36-7"></a>    <span class="fu">across</span>(PV1MATH_weighted<span class="sc">:</span>PV10MATH_weighted, <span class="sc">~</span> <span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_weight, <span class="at">.names =</span> <span class="st">"{.col}_mean"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Finally, we calculated the mean of the <code>PV1MATH_weighted_mean</code>, <code>PV2MATH_weighted_mean</code>, … <code>PV10MATH_weighted_mean</code> columns. I have arranged the results in descending order.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">select</span>(CNT, W_FSTUWT, PV1MATH<span class="sc">:</span>PV10MATH) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(PV1MATH<span class="sc">:</span>PV10MATH, <span class="sc">~</span> .x <span class="sc">*</span> W_FSTUWT, <span class="at">.names =</span> <span class="st">"{.col}_weighted"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fu">summarise</span>(</span>
<span id="cb37-6"><a href="#cb37-6"></a>    <span class="at">total_weight =</span> <span class="fu">sum</span>(W_FSTUWT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-7"><a href="#cb37-7"></a>    <span class="fu">across</span>(PV1MATH_weighted<span class="sc">:</span>PV10MATH_weighted, <span class="sc">~</span> <span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> total_weight, <span class="at">.names =</span> <span class="st">"{.col}_mean"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">mutate</span>(<span class="at">PV_mean_weighted =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="fu">ends_with</span>(<span class="st">"_mean"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="fu">select</span>(CNT, PV_mean_weighted) <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fu">mutate</span>(<span class="at">PV_mean_weighted =</span> <span class="fu">round</span>(PV_mean_weighted, <span class="at">digits =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(PV_mean_weighted))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 80 × 2
# Rowwise: 
   CNT                          PV_mean_weighted
   &lt;fct&gt;                                   &lt;dbl&gt;
 1 Singapore                                575.
 2 Macao (China)                            552.
 3 Chinese Taipei                           547.
 4 Hong Kong (China)                        540.
 5 Japan                                    536.
 6 Korea                                    527.
 7 Estonia                                  510.
 8 Switzerland                              508 
 9 Canada                                   497.
10 Netherlands                              493.
11 Ireland                                  492.
12 Belgium                                  490.
13 Denmark                                  489.
14 United Kingdom                           489 
15 Poland                                   489 
16 Austria                                  487.
17 Australia                                487.
18 Czech Republic                           487 
19 Slovenia                                 484.
20 Finland                                  484.
21 Latvia                                   483.
22 Sweden                                   482.
23 New Zealand                              479.
24 Lithuania                                475.
25 Germany                                  475.
26 France                                   474.
27 Spain                                    473.
28 Hungary                                  473.
29 Portugal                                 472.
30 Italy                                    471.
31 Viet Nam                                 469.
32 Norway                                   468.
33 Malta                                    466 
34 United States                            465.
35 Slovak Republic                          464 
36 Croatia                                  463.
37 Iceland                                  459.
38 Israel                                   458.
39 Türkiye                                  453.
40 Brunei Darussalam                        442.
41 Ukrainian regions (18 of 27)             441.
42 Serbia                                   440.
43 United Arab Emirates                     431.
44 Greece                                   430.
45 Romania                                  428.
46 Kazakhstan                               425.
47 Mongolia                                 425.
48 Bulgaria                                 417.
49 Republic of Moldova                      414.
50 Qatar                                    414.
51 Chile                                    412.
52 Malaysia                                 409.
53 Uruguay                                  409.
54 Montenegro                               406.
55 Baku (Azerbaijan)                        397.
56 Mexico                                   395 
57 Thailand                                 394.
58 Peru                                     391.
59 Georgia                                  390 
60 Saudi Arabia                             389.
61 North Macedonia                          389.
62 Costa Rica                               385.
63 Colombia                                 383.
64 Brazil                                   379.
65 Argentina                                378.
66 Jamaica                                  377.
67 Albania                                  368.
68 Palestinian Authority                    366.
69 Indonesia                                366.
70 Morocco                                  365.
71 Uzbekistan                               364.
72 Jordan                                   361.
73 Panama                                   357.
74 Kosovo                                   355 
75 Philippines                              355.
76 Guatemala                                344.
77 El Salvador                              344.
78 Dominican Republic                       339.
79 Paraguay                                 338.
80 Cambodia                                 336.</code></pre>
</div>
</div>
<p>This output matches the PISA published values for 2022.</p>
<p>Add @ http://repec.ioe.ac.uk/REPEc/pdf/qsswp1704.pdf</p>
<p>When performing tests (for example, t-tests or linear regressions) the recommended approach is to:Rubin’s rules for multiple imputation as recommended by the OECD <span class="citation" data-cites="rubin1987multiple">OECD (<a href="#ref-OECD2009tech" role="doc-biblioref">2009a</a>)</span> : a) estimate a statistic multiple times, once each for each plausible value; b) average the values produced; c) estimate the magnitude of the imputation error; and d) calculate the final standard error from the sampling error and the imputation error.</p>
<p>Hence, if you were performing a linear model you should a) weight the raw scores you intend to use; b) run the model ten times, once each for each of the plausible values; c) calculate the average outcome metrics. For example, your code might look like this:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># a function that returns the models for a given formula</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="co"># formula must include exactly one PV</span></span>
<span id="cb39-3"><a href="#cb39-3"></a>multi_pv_lm <span class="ot">&lt;-</span> <span class="cf">function</span>(model_data,</span>
<span id="cb39-4"><a href="#cb39-4"></a>                        pv_formula,</span>
<span id="cb39-5"><a href="#cb39-5"></a>                        <span class="at">pv_vals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb39-6"><a href="#cb39-6"></a>                        <span class="at">weight_id =</span> <span class="st">"W_FSTUWT"</span>){</span>
<span id="cb39-7"><a href="#cb39-7"></a></span>
<span id="cb39-8"><a href="#cb39-8"></a>  pv_focus_orig <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(pv_formula, <span class="st">"PV[0-9]+[A-Z]{4}"</span>)</span>
<span id="cb39-9"><a href="#cb39-9"></a>  pv_focus <span class="ot">&lt;-</span> pv_focus_orig <span class="sc">%&gt;%</span> <span class="fu">str_remove</span>(<span class="st">"PV[0-9]*"</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="fu">message</span>(<span class="st">"focusing on "</span>, pv_focus)</span>
<span id="cb39-11"><a href="#cb39-11"></a></span>
<span id="cb39-12"><a href="#cb39-12"></a>  <span class="cf">if</span>(weight_id <span class="sc">%in%</span> <span class="fu">names</span>(model_data)){</span>
<span id="cb39-13"><a href="#cb39-13"></a>    <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Weighting by {weight_id}"</span>))</span>
<span id="cb39-14"><a href="#cb39-14"></a>  } <span class="cf">else</span> {</span>
<span id="cb39-15"><a href="#cb39-15"></a>    <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"No {weight_id} weight variable found"</span>))</span>
<span id="cb39-16"><a href="#cb39-16"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb39-17"><a href="#cb39-17"></a>  }</span>
<span id="cb39-18"><a href="#cb39-18"></a>  </span>
<span id="cb39-19"><a href="#cb39-19"></a>  <span class="co"># List of plausible value column names</span></span>
<span id="cb39-20"><a href="#cb39-20"></a>  pv_columns <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"PV"</span>, pv_vals, pv_focus)</span>
<span id="cb39-21"><a href="#cb39-21"></a>  </span>
<span id="cb39-22"><a href="#cb39-22"></a>  results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(pv_columns, \(pv){</span>
<span id="cb39-23"><a href="#cb39-23"></a>    pv_formula_map <span class="ot">&lt;-</span> <span class="fu">str_replace</span>(pv_formula, pv_focus_orig, pv)</span>
<span id="cb39-24"><a href="#cb39-24"></a></span>
<span id="cb39-25"><a href="#cb39-25"></a>    <span class="fu">message</span>(pv)</span>
<span id="cb39-26"><a href="#cb39-26"></a>    <span class="co"># run model</span></span>
<span id="cb39-27"><a href="#cb39-27"></a>    model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">as.formula</span>(pv_formula_map), </span>
<span id="cb39-28"><a href="#cb39-28"></a>                <span class="at">data =</span> model_data, </span>
<span id="cb39-29"><a href="#cb39-29"></a>                <span class="at">weights =</span> model_data[[weight_id]])</span>
<span id="cb39-30"><a href="#cb39-30"></a>    <span class="co"># extract summary</span></span>
<span id="cb39-31"><a href="#cb39-31"></a>    model_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)</span>
<span id="cb39-32"><a href="#cb39-32"></a>    </span>
<span id="cb39-33"><a href="#cb39-33"></a>    <span class="co"># return rows</span></span>
<span id="cb39-34"><a href="#cb39-34"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>(model_summary) <span class="sc">%&gt;%</span> </span>
<span id="cb39-35"><a href="#cb39-35"></a>      <span class="fu">mutate</span>(<span class="at">R2 =</span> model_summary<span class="sc">$</span>r.squared) <span class="sc">%&gt;%</span></span>
<span id="cb39-36"><a href="#cb39-36"></a>      <span class="fu">mutate</span>(<span class="at">PV =</span> pv)</span>
<span id="cb39-37"><a href="#cb39-37"></a>  })</span>
<span id="cb39-38"><a href="#cb39-38"></a>  </span>
<span id="cb39-39"><a href="#cb39-39"></a>  results_flat <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span> </span>
<span id="cb39-40"><a href="#cb39-40"></a>    <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(term, <span class="st">"PV[0-9]+[A-Z]{4}"</span>), </span>
<span id="cb39-41"><a href="#cb39-41"></a>                         <span class="fu">glue</span>(<span class="st">"PV_{pv_focus}"</span>), </span>
<span id="cb39-42"><a href="#cb39-42"></a>                         term)) <span class="sc">%&gt;%</span></span>
<span id="cb39-43"><a href="#cb39-43"></a>    <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span> </span>
<span id="cb39-44"><a href="#cb39-44"></a>    <span class="fu">summarise</span>(<span class="at">estimate_mean =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb39-45"><a href="#cb39-45"></a>              <span class="at">estimate_sd =</span> <span class="fu">sd</span>(estimate),</span>
<span id="cb39-46"><a href="#cb39-46"></a>              <span class="at">std_error_mean =</span> <span class="fu">mean</span>(std.error),</span>
<span id="cb39-47"><a href="#cb39-47"></a>              <span class="at">std_error_sd =</span> <span class="fu">sd</span>(std.error),</span>
<span id="cb39-48"><a href="#cb39-48"></a>              <span class="at">statistic_mean =</span> <span class="fu">mean</span>(statistic),</span>
<span id="cb39-49"><a href="#cb39-49"></a>              <span class="at">statistic_sd =</span> <span class="fu">sd</span>(statistic),</span>
<span id="cb39-50"><a href="#cb39-50"></a>              <span class="at">p_value_mean =</span> <span class="fu">mean</span>(p.value),</span>
<span id="cb39-51"><a href="#cb39-51"></a>              <span class="at">p_value_sd =</span> <span class="fu">sd</span>(p.value),</span>
<span id="cb39-52"><a href="#cb39-52"></a>              <span class="at">r2 =</span> <span class="fu">max</span>(R2))</span>
<span id="cb39-53"><a href="#cb39-53"></a>  </span>
<span id="cb39-54"><a href="#cb39-54"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">results=</span>results, </span>
<span id="cb39-55"><a href="#cb39-55"></a>              <span class="at">results_flat=</span>results_flat))</span>
<span id="cb39-56"><a href="#cb39-56"></a>}</span>
<span id="cb39-57"><a href="#cb39-57"></a></span>
<span id="cb39-58"><a href="#cb39-58"></a><span class="co"># we can call the model comparison, like so:</span></span>
<span id="cb39-59"><a href="#cb39-59"></a>mdl_pvs_math <span class="ot">&lt;-</span> <span class="fu">multi_pv_lm</span>(PISA_2022, <span class="st">"PV1MATH ~ HOMEPOS + ESCS"</span>)</span>
<span id="cb39-60"><a href="#cb39-60"></a></span>
<span id="cb39-61"><a href="#cb39-61"></a><span class="co"># You can then access the full model responses through:</span></span>
<span id="cb39-62"><a href="#cb39-62"></a>mdl_pvs_math<span class="sc">$</span>results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 7
   term        estimate std.error statistic p.value    R2 PV      
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
 1 (Intercept)    459.      0.131    3515.        0 0.290 PV1MATH 
 2 HOMEPOS         34.3     0.154     223.        0 0.290 PV1MATH 
 3 ESCS            10.7     0.153      69.8       0 0.290 PV1MATH 
 4 (Intercept)    459.      0.130    3524.        0 0.289 PV2MATH 
 5 HOMEPOS         34.4     0.154     224.        0 0.289 PV2MATH 
 6 ESCS            10.5     0.153      68.4       0 0.289 PV2MATH 
 7 (Intercept)    459.      0.130    3524.        0 0.290 PV3MATH 
 8 HOMEPOS         34.2     0.154     223.        0 0.290 PV3MATH 
 9 ESCS            10.8     0.153      70.6       0 0.290 PV3MATH 
10 (Intercept)    459.      0.130    3530.        0 0.291 PV4MATH 
11 HOMEPOS         34.4     0.153     224.        0 0.291 PV4MATH 
12 ESCS            10.6     0.152      69.3       0 0.291 PV4MATH 
13 (Intercept)    459.      0.130    3528.        0 0.292 PV5MATH 
14 HOMEPOS         34.5     0.154     224.        0 0.292 PV5MATH 
15 ESCS            10.7     0.153      70.1       0 0.292 PV5MATH 
16 (Intercept)    459.      0.131    3514.        0 0.290 PV6MATH 
17 HOMEPOS         34.3     0.154     223.        0 0.290 PV6MATH 
18 ESCS            10.7     0.153      70.0       0 0.290 PV6MATH 
19 (Intercept)    459.      0.130    3525.        0 0.291 PV7MATH 
20 HOMEPOS         34.5     0.154     225.        0 0.291 PV7MATH 
21 ESCS            10.5     0.153      68.9       0 0.291 PV7MATH 
22 (Intercept)    459.      0.130    3525.        0 0.292 PV8MATH 
23 HOMEPOS         34.4     0.154     224.        0 0.292 PV8MATH 
24 ESCS            10.8     0.153      70.6       0 0.292 PV8MATH 
25 (Intercept)    459.      0.130    3524.        0 0.291 PV9MATH 
26 HOMEPOS         34.3     0.154     223.        0 0.291 PV9MATH 
27 ESCS            10.7     0.153      70.1       0 0.291 PV9MATH 
28 (Intercept)    459.      0.130    3526.        0 0.292 PV10MATH
29 HOMEPOS         34.3     0.154     223.        0 0.292 PV10MATH
30 ESCS            10.9     0.153      71.6       0 0.292 PV10MATH</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># or the mean values for model outcomes with:</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>mdl_pvs_math<span class="sc">$</span>results_flat</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  term      estimate_mean estimate_sd std_error_mean std_error_sd statistic_mean
  &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;
1 (Interce…         459.       0.128           0.130     0.000189         3523. 
2 ESCS               10.7      0.140           0.153     0.000221           69.9
3 HOMEPOS            34.4      0.0896          0.154     0.000223          224. 
# ℹ 4 more variables: statistic_sd &lt;dbl&gt;, p_value_mean &lt;dbl&gt;, p_value_sd &lt;dbl&gt;,
#   r2 &lt;dbl&gt;</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>mdl_pvs_read <span class="ot">&lt;-</span> <span class="fu">multi_pv_lm</span>(PISA_2022, <span class="st">"ESCS ~ HOMEPOS + PV1READ"</span>)</span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co"># </span><span class="al">TODO</span><span class="co">: https://bookdown.org/mwheymans/bookmi/rubins-rules.html</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="questions" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Questions</h1>
<section id="where-can-i-find-examples-of-pisa-test-items" class="level2" data-number="5.1"><h2 data-number="5.1" class="anchored" data-anchor-id="where-can-i-find-examples-of-pisa-test-items">
<span class="header-section-number">5.1</span> Where can I find examples of PISA test items?</h2>
<p>The OECD do not release the full question set used in the PISA science, reading and mathematics tests in order to allow questions to be reused across cycles to allow valid inferences. However, you can find a document of items used in PISA 2000, 2003, 2006 and <a href="https://www.oecd.org/en/publications/take-the-test_9789264050815-en.html">some test items here</a> which give a flavour of the nature of the tests.</p>
</section><section id="why-are-some-countries-oecd-countries-and-others-arent" class="level2" data-number="5.2"><h2 data-number="5.2" class="anchored" data-anchor-id="why-are-some-countries-oecd-countries-and-others-arent">
<span class="header-section-number">5.2</span> Why are some countries OECD countries and others aren’t?</h2>
<p>The Organisation for Economic Co-operation and Development (OECD) has 38 member states. PISA is run by the OECD and its member states normally take part in each PISA cycle, but other countries are allowed to take part as <em>Partners</em>. You can find more details on participation <a href="https://www.oecd.org/pisa/aboutpisa/pisa-participants.htm">here</a>.</p>
<p>Results for OECD members are generally higher than for Partner countries:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">group_by</span>(OECD) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3"></a>  <span class="fu">summarise</span>(<span class="at">country_n =</span> <span class="fu">length</span>(<span class="fu">unique</span>(CNT)),</span>
<span id="cb44-4"><a href="#cb44-4"></a>            <span class="at">math_mean =</span> <span class="fu">mean</span>(PV1MATH, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-5"><a href="#cb44-5"></a>            <span class="at">math_sd =</span> <span class="fu">sd</span>(PV1MATH, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-6"><a href="#cb44-6"></a>            <span class="at">students_n =</span> <span class="fu">n</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  OECD  country_n math_mean math_sd students_n
  &lt;fct&gt;     &lt;int&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;int&gt;
1 No           43      409.    97.8     318587
2 Yes          37      475.    95.0     295157</code></pre>
</div>
</div>
</section><section id="why-are-the-pv-grades-pivoting-around-the-500-mark" class="level2" data-number="5.3"><h2 data-number="5.3" class="anchored" data-anchor-id="why-are-the-pv-grades-pivoting-around-the-500-mark">
<span class="header-section-number">5.3</span> Why are the PV grades pivoting around the ~500 mark?</h2>
<p>The scores for students in mathematics, reading and science are scaled so that the mean of students in OECD countries is roughly 500 points with a standard deviation of 100 points. To see this, run the following code:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">filter</span>(OECD<span class="sc">==</span><span class="st">"Yes"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="fu">summarise</span>(<span class="at">math_mean =</span> <span class="fu">mean</span>(PV1MATH, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-4"><a href="#cb46-4"></a>            <span class="at">math_sd =</span> <span class="fu">sd</span>(PV1MATH, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-5"><a href="#cb46-5"></a>            <span class="at">scie_mean =</span> <span class="fu">mean</span>(PV1SCIE, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-6"><a href="#cb46-6"></a>            <span class="at">scie_sd =</span> <span class="fu">sd</span>(PV1SCIE, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-7"><a href="#cb46-7"></a>            <span class="at">read_mean =</span> <span class="fu">mean</span>(PV1READ, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb46-8"><a href="#cb46-8"></a>            <span class="at">read_sd =</span> <span class="fu">sd</span>(PV1READ, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  math_mean math_sd scie_mean scie_sd read_mean read_sd
      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1      475.    95.0      487.    101.      478.    104.</code></pre>
</div>
</div>
</section><section id="but-the-mean-pv-score-isnt-500" class="level2" data-number="5.4"><h2 data-number="5.4" class="anchored" data-anchor-id="but-the-mean-pv-score-isnt-500">
<span class="header-section-number">5.4</span> But the mean PV score isn’t 500?!</h2>
<p>The OECD’s initial plan (in the 2000 study) was that the mean PC score for OECD countries should be 500 and the standard deviation 100 <span class="citation" data-cites="pisa2018results">(<a href="#ref-pisa2018results" role="doc-biblioref">OECD 2019a</a>)</span>. However, after the 2000 study, scores were scaled to be comparable with the first cycle of data, resulting in means differing from 500 <span class="citation" data-cites="pulkkinen2022correspondence">(<a href="#ref-pulkkinen2022correspondence" role="doc-biblioref">Pulkkinen and Rautopuro 2022</a>)</span>. For example, by 2015, the mean for science had fallen to 493 in science and reading, and 490 in mathematics.</p>
</section><section id="why-are-the-letters-ta-and-na-used-in-some-field-names" class="level2" data-number="5.5"><h2 data-number="5.5" class="anchored" data-anchor-id="why-are-the-letters-ta-and-na-used-in-some-field-names">
<span class="header-section-number">5.5</span> Why are the letters TA and NA used in some field names?</h2>
</section><section id="how-do-i-find-fields-that-are-numeric" class="level2" data-number="5.6"><h2 data-number="5.6" class="anchored" data-anchor-id="how-do-i-find-fields-that-are-numeric">
<span class="header-section-number">5.6</span> How do I find fields that are numeric?</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># using the following code!</span></span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>nms <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span> <span class="fu">names</span>()</span>
<span id="cb48-4"><a href="#cb48-4"></a>lbls <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(nms,\(nme){</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="fu">message</span>(nme)</span>
<span id="cb48-6"><a href="#cb48-6"></a>  lbl <span class="ot">&lt;-</span> <span class="fu">attr</span>(PISA_2022[[nme]], <span class="st">"label"</span>)</span>
<span id="cb48-7"><a href="#cb48-7"></a>  row <span class="ot">&lt;-</span> <span class="fu">c</span>(nme, lbl)</span>
<span id="cb48-8"><a href="#cb48-8"></a>  <span class="fu">names</span>(row) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"label"</span>)</span>
<span id="cb48-9"><a href="#cb48-9"></a>  <span class="fu">return</span>(row)</span>
<span id="cb48-10"><a href="#cb48-10"></a>})</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="how-are-schools-and-students-selected-to-take-part-in-pisa" class="level2" data-number="5.7"><h2 data-number="5.7" class="anchored" data-anchor-id="how-are-schools-and-students-selected-to-take-part-in-pisa">
<span class="header-section-number">5.7</span> How are schools and students selected to take part in PISA?</h2>
<p>The students who take part in the PISA study are aged between 15 years and 3 (completed) months and 16 years and 2 (completed) months at the beginning of the testing period <span class="citation" data-cites="OECD2018technical">(<a href="#ref-OECD2018technical" role="doc-biblioref">OECD 2018</a>)</span>. A number of classes of students can be excluded from data collection, up to 5% of all sampled students:</p>
<ul>
<li>Students classed as ‘functionally disabled’ so that they cannot participate in the test.</li>
<li>Judged by teachers to have cognitive, emotional or behavioural difficulties that mean they cannot participate.</li>
<li>The student lacks language abilities to take the test in the assessment language.</li>
<li>There are no test material available in the student’s language</li>
<li>Another agreed reason</li>
</ul>
<p>The OECD expect that 85% of schools in their original sample participate - non participating schools can be replaced with a substitute, ‘replacement’ school. These replacement schools are similar in terms of a set of observable characteristics, that can be different depending on the country, for example in Canada this includes school funding and public/private school type<!--https://youtu.be/Yrud2pi5NOQ?si=0lwBkvWRDFYGjt5Y&t=1440-->. A minimum weighted response rate of 80% is required within schools.</p>
<p>The sampling strategy for PISA is a stratified two-stage sample design. That is schools are sampled to represent proportional distribution by size (referring to the number of enrolled 15-year-olds) sampling. Within schools, students are sampled with equal probability.</p>
<p>Schools are allowed to exclude students from their cohorts, based on the criteria given above. In 2015 the median exclusion rate from the sample was 3% for all OECD schools, with South Korea excluding 1% of students, and the UK excluding 8%. <!--https://youtu.be/Yrud2pi5NOQ?si=5bLRMicEI9fic6x1&t=1260  --></p>
<p><span class="citation" data-cites="Jerrim2020">(<a href="#ref-Jerrim2020" role="doc-biblioref"><strong>Jerrim2020?</strong></a>)</span> argues that countries stretching the sampling rules above might allow for a country to lose 50% of eligible students from its sample and still be within the PISA rules for inclusion in the data set(!). In 2015, 91% of eligible student population in Japan were covered by the sampling, for the UK this was 69%, and for Canada, the top performing country for reading in that year’s study, the sample covered only 53% of the eligible student population. <!--https://youtu.be/Yrud2pi5NOQ?si=abMiS6_PC4H0KZGR&t=1860--></p>
<p>Add Christian Bokhove papers https://bokhove.net/r-materials/</p>
<p>From the data, you can see that 50% of schools entered fewer than 30 students into PISA.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">group_by</span>(CNTSCHID) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">summarise</span>(<span class="at">size =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">mutate</span>(<span class="at">quartile =</span> <span class="fu">ntile</span>(size, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5"></a>  <span class="fu">group_by</span>(quartile) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6"></a>  <span class="fu">summarise</span>(<span class="at">Qmax =</span> <span class="fu">max</span>(size),</span>
<span id="cb49-7"><a href="#cb49-7"></a>            <span class="at">Qmedian =</span> <span class="fu">median</span>(size),</span>
<span id="cb49-8"><a href="#cb49-8"></a>            <span class="at">Qmean =</span> <span class="fu">mean</span>(size))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  quartile  Qmax Qmedian Qmean
     &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;dbl&gt;
1        1    19      10  10.1
2        2    30      25  25.2
3        3    37      34  33.8
4        4   475      40  44.4</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">ggplot</span>(PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">group_by</span>(CNTSCHID) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">summarise</span>(<span class="at">size =</span> <span class="fu">n</span>()), <span class="fu">aes</span>(<span class="at">x=</span>size)) <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">geom_density</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="A1-PISA_analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="what-are-the-pisa-test-questions-like" class="level2" data-number="5.8"><h2 data-number="5.8" class="anchored" data-anchor-id="what-are-the-pisa-test-questions-like">
<span class="header-section-number">5.8</span> What are the PISA test questions like?</h2>
<p>You can view sample PISA science, reading and mathematics questions <a href="https://www.oecd.org/pisa/test/">here</a>.</p>
</section><section id="how-can-i-find-the-ethnicity-or-race-of-a-student-taking-the-pisa-test" class="level2" data-number="5.9"><h2 data-number="5.9" class="anchored" data-anchor-id="how-can-i-find-the-ethnicity-or-race-of-a-student-taking-the-pisa-test">
<span class="header-section-number">5.9</span> How can I find the ethnicity or race of a student taking the PISA test?</h2>
<p>This data isn’t collected by PISA. Instead they collect information on the language spoken at home (<code>LANGN</code>) and the language of the test (<code>LANGTEST_QQQ</code>), as well as the immigration status and country of birth (<code>COBN_S</code> student, <code>COBN_M</code> mother, <code>COBN_F</code> father). Details on ethnicity and outcomes in the England are published through the <a href="https://assets.publishing.service.gov.uk/media/5f20293fd3bf7f1b0fa79fa3/PISA_2018_England_national_report_accessible.pdf">country specific research report</a> for 2018. Note that Chinese students are categorised under “Other” rather than “Asian” in UK data sets.</p>
</section><section id="what-are-the-pisa-domains" class="level2" data-number="5.10"><h2 data-number="5.10" class="anchored" data-anchor-id="what-are-the-pisa-domains">
<span class="header-section-number">5.10</span> What are the PISA domains?</h2>
<p>Every PISA test has included test items measuring literacy, numeracy and science. In each cycle, one of three areas is the focus of study (the major domain). In addition, extra domains have been added to cycles (for example, creative thinking and collaborative problem solving). The additional domains are shown in the table below.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 56%">
</colgroup>
<thead><tr class="header">
<th>Year</th>
<th>Major Domain</th>
<th>Minor Domains</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>2000</strong></td>
<td>Reading literacy</td>
<td>Mathematics, Science</td>
</tr>
<tr class="even">
<td><strong>2003</strong></td>
<td>Mathematics</td>
<td>Reading literacy, Science, Cross-curricular problem solving</td>
</tr>
<tr class="odd">
<td><strong>2006</strong></td>
<td>Science</td>
<td>Reading literacy, Mathematics</td>
</tr>
<tr class="even">
<td><strong>2009</strong></td>
<td>Reading literacy</td>
<td>Mathematics, Science</td>
</tr>
<tr class="odd">
<td><strong>2012</strong></td>
<td>Mathematics</td>
<td>Reading literacy, Science, Creative problem solving</td>
</tr>
<tr class="even">
<td><strong>2015</strong></td>
<td>Science</td>
<td>Mathematics, Reading literacy, Collaborative problem solving</td>
</tr>
<tr class="odd">
<td><strong>2018</strong></td>
<td>Reading literacy</td>
<td>Mathematics, Science, Global Competence</td>
</tr>
<tr class="even">
<td><strong>2022</strong></td>
<td>Mathematics</td>
<td>Reading literacy, Science, Creative thinking</td>
</tr>
<tr class="odd">
<td><strong>2025</strong></td>
<td>Science</td>
<td>Mathematics, Reading literacy, Learning in the Digital World</td>
</tr>
</tbody>
</table></section><section id="why-is-china-given-the-cnt-value-b-s-j-z-china-2018-or-b-s-j-g-china-2015" class="level2" data-number="5.11"><h2 data-number="5.11" class="anchored" data-anchor-id="why-is-china-given-the-cnt-value-b-s-j-z-china-2018-or-b-s-j-g-china-2015">
<span class="header-section-number">5.11</span> Why is China given the <code>CNT</code> value <code>B-S-J-Z (China)</code> (2018) or <code>B-S-J-G (China)</code> (2015)?</h2>
<p>B-S-J-G/Z (China) is an acronym for Beijing, Shanghai, Jiangsu and Guangdong/Zhejiang, the four provinces/municipalities of the People’s Republic of China that take part in PISA data collection. Zhejiang took the place of Guangdong in the 2018 dataset. Several authors (including <span class="citation" data-cites="du2019science">(<a href="#ref-du2019science" role="doc-biblioref">Du and Wong 2019</a>)</span>) comment that sampling only from some of the most developed regions of China means the country’s data is unlikely to be nationally representative.</p>
</section><section id="where-is-mainland-china-in-pisa-2022" class="level2" data-number="5.12"><h2 data-number="5.12" class="anchored" data-anchor-id="where-is-mainland-china-in-pisa-2022">
<span class="header-section-number">5.12</span> Where is mainland China in PISA 2022?</h2>
<blockquote class="blockquote">
<p>Chinese provinces/municipalities (Beijing, Shanghai, Jiangsu and Zhejiang) and Lebanon are participants in PISA 2022 but were unable to collect data because schools were closed during the intended data collection period. - <a href="https://www.oecd.org/pisa/aboutpisa/pisa-2022-participants.htm">PISA 2022 participants</a></p>
</blockquote>
</section><section id="how-do-i-calculate-weighted-means-of-the-pv-scores" class="level2" data-number="5.13"><h2 data-number="5.13" class="anchored" data-anchor-id="how-do-i-calculate-weighted-means-of-the-pv-scores">
<span class="header-section-number">5.13</span> How do I calculate weighted means of the PV scores?</h2>
<p>You can use a function written by Miguel Diaz Kusztrick, here is his slightly tidied function for calculating weighted means and standard deviations (<a href="https://web.archive.org/web/20230208113351/http://software-tecnico-libre.es/en/article-by-topic/all-sections/all-topics/all-articles/pisa-database-plausible-values-r-code">original link</a>):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># Copyright Miguel Diaz Kusztrick</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>wght_meansd_pv <span class="ot">&lt;-</span> <span class="cf">function</span>(sdata, pv, weight, brr) {</span>
<span id="cb52-3"><a href="#cb52-3"></a>    mmeans  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="fu">names</span>(mmeans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"MEAN"</span>,<span class="st">"SE-MEAN"</span>,<span class="st">"STDEV"</span>,<span class="st">"SE-STDEV"</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>    </span>
<span id="cb52-6"><a href="#cb52-6"></a>    mmeanspv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(pv))</span>
<span id="cb52-7"><a href="#cb52-7"></a>    stdspv   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(pv))</span>
<span id="cb52-8"><a href="#cb52-8"></a>    mmeansbr <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(pv))</span>
<span id="cb52-9"><a href="#cb52-9"></a>    stdsbr   <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(pv))</span>
<span id="cb52-10"><a href="#cb52-10"></a>    sum_weight <span class="ot">&lt;-</span> <span class="fu">sum</span>(sdata[,weight])</span>
<span id="cb52-11"><a href="#cb52-11"></a>    </span>
<span id="cb52-12"><a href="#cb52-12"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pv)) {</span>
<span id="cb52-13"><a href="#cb52-13"></a>        mmeanspv[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(sdata[,weight]<span class="sc">*</span>sdata[,pv[i]])<span class="sc">/</span>sum_weight</span>
<span id="cb52-14"><a href="#cb52-14"></a>        stdspv[i]   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(sdata[,weight]<span class="sc">*</span>(sdata[,pv[i]]<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>swght)<span class="sc">-</span>mmeanspv[i]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-15"><a href="#cb52-15"></a>        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(brr)) {</span>
<span id="cb52-16"><a href="#cb52-16"></a>            sbrr<span class="ot">&lt;-</span><span class="fu">sum</span>(sdata[,brr[j]])</span>
<span id="cb52-17"><a href="#cb52-17"></a>            mbrrj<span class="ot">&lt;-</span><span class="fu">sum</span>(sdata[,brr[j]]<span class="sc">*</span>sdata[,pv[i]])<span class="sc">/</span>sbrr</span>
<span id="cb52-18"><a href="#cb52-18"></a>            mmeansbr[i]<span class="ot">&lt;-</span>mmeansbr[i] <span class="sc">+</span> (mbrrj <span class="sc">-</span> mmeanspv[i])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb52-19"><a href="#cb52-19"></a>            stdsbr[i]<span class="ot">&lt;-</span>stdsbr[i] <span class="sc">+</span> (<span class="fu">sqrt</span>((<span class="fu">sum</span>(sdata[,brr[j]]<span class="sc">*</span>(sdata[,pv[i]]<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>sbrr)<span class="sc">-</span>mbrrj<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> stdspv[i])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb52-20"><a href="#cb52-20"></a>        }       </span>
<span id="cb52-21"><a href="#cb52-21"></a>    }</span>
<span id="cb52-22"><a href="#cb52-22"></a>    mmeans[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(mmeanspv) <span class="sc">/</span> <span class="fu">length</span>(pv)</span>
<span id="cb52-23"><a href="#cb52-23"></a>    mmeans[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>((mmeansbr <span class="sc">*</span> <span class="dv">4</span>) <span class="sc">/</span> <span class="fu">length</span>(brr)) <span class="sc">/</span> <span class="fu">length</span>(pv)</span>
<span id="cb52-24"><a href="#cb52-24"></a>    mmeans[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(stdspv) <span class="sc">/</span> <span class="fu">length</span>(pv)</span>
<span id="cb52-25"><a href="#cb52-25"></a>    mmeans[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>((stdsbr <span class="sc">*</span> <span class="dv">4</span>) <span class="sc">/</span> <span class="fu">length</span>(brr)) <span class="sc">/</span> <span class="fu">length</span>(pv)</span>
<span id="cb52-26"><a href="#cb52-26"></a>    ivar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb52-27"><a href="#cb52-27"></a>    </span>
<span id="cb52-28"><a href="#cb52-28"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pv)) {</span>
<span id="cb52-29"><a href="#cb52-29"></a>        ivar[<span class="dv">1</span>] <span class="ot">&lt;-</span> ivar[<span class="dv">1</span>] <span class="sc">+</span> (mmeanspv[i] <span class="sc">-</span> mmeans[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span>;</span>
<span id="cb52-30"><a href="#cb52-30"></a>        ivar[<span class="dv">2</span>] <span class="ot">&lt;-</span> ivar[<span class="dv">2</span>] <span class="sc">+</span> (stdspv[i] <span class="sc">-</span> mmeans[<span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span>;</span>
<span id="cb52-31"><a href="#cb52-31"></a>    }</span>
<span id="cb52-32"><a href="#cb52-32"></a>    ivar <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">length</span>(pv))) <span class="sc">*</span> (ivar <span class="sc">/</span> (<span class="fu">length</span>(pv) <span class="sc">-</span> <span class="dv">1</span>));</span>
<span id="cb52-33"><a href="#cb52-33"></a>    mmeans[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mmeans[<span class="dv">2</span>] <span class="sc">+</span> ivar[<span class="dv">1</span>]);</span>
<span id="cb52-34"><a href="#cb52-34"></a>    mmeans[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mmeans[<span class="dv">4</span>] <span class="sc">+</span> ivar[<span class="dv">2</span>]);</span>
<span id="cb52-35"><a href="#cb52-35"></a>    <span class="fu">return</span>(mmeans);</span>
<span id="cb52-36"><a href="#cb52-36"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="pisa-quirks" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> PISA quirks</h1>
<section id="empty-fields" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="empty-fields">
<span class="header-section-number">6.1</span> Empty fields</h2>
<p>GROSAGR Growth Mindset (WLE) seems to be completely missing for all countries:</p>
<p>All 2022 school responses to questions about the clubs and extra curricular activities run in a school <code>SC053Q____</code> are coded as <code>NA</code>, as are <code>SC207____</code>. It’s not clear why this data is included in the dataset or whether this data should have values but doesn’t. These (albeit empty) fields are included in the full <code>PISA_school_2022.parquet</code> file linked above.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>club_flds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"SC053Q01TA"</span>,<span class="st">"SC053Q02TA"</span>,<span class="st">"SC053Q03TA"</span>,<span class="st">"SC053Q04TA"</span>,<span class="st">"SC053Q05NA"</span>,</span>
<span id="cb53-2"><a href="#cb53-2"></a>               <span class="st">"SC053Q06NA"</span>,<span class="st">"SC053Q07TA"</span>,<span class="st">"SC053Q08TA"</span>,<span class="st">"SC053Q09TA"</span>,<span class="st">"SC053Q10TA"</span>)</span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a>PISA_2022_school <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="#cb53-5"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"CNT"</span>, <span class="fu">starts_with</span>(<span class="st">"SC053Q"</span>), <span class="fu">starts_with</span>(<span class="st">"SC207"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb53-6"><a href="#cb53-6"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CNT, </span>
<span id="cb53-8"><a href="#cb53-8"></a>               <span class="at">names_to =</span> <span class="st">"club"</span>,</span>
<span id="cb53-9"><a href="#cb53-9"></a>               <span class="at">values_to =</span> <span class="st">"present"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="#cb53-10"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(present)) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11"></a>  <span class="fu">pull</span>(club) <span class="sc">%&gt;%</span> </span>
<span id="cb53-12"><a href="#cb53-12"></a>  <span class="fu">unique</span>()</span>
<span id="cb53-13"><a href="#cb53-13"></a></span>
<span id="cb53-14"><a href="#cb53-14"></a><span class="co"># Note: SC053D11TA is present:</span></span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="co"># &lt;This academic year&gt;,follow. activities/school offers&lt;national modal grade for 15-year-olds&gt;? &lt;country specific item&gt;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Additionally, <em>creativity</em> fields stored in <code>ST334_____</code>, <code>ST340_____</code>, <code>ST341_____</code>, <code>PA185_____</code> and <code>CREA____</code> on the student questionnaire are missing answers for all countries:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>PISA_2022 <span class="ot">&lt;-</span> <span class="fu">read_feather</span>(<span class="fu">glue</span>(<span class="st">"{pisa_data}2022/PISA_student_2022.feather"</span>)) </span>
<span id="cb54-2"><a href="#cb54-2"></a>PISA_2022 <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"CNT"</span>, </span>
<span id="cb54-4"><a href="#cb54-4"></a>           <span class="fu">starts_with</span>(<span class="st">"ST334"</span>),</span>
<span id="cb54-5"><a href="#cb54-5"></a>           <span class="fu">starts_with</span>(<span class="st">"ST340"</span>), </span>
<span id="cb54-6"><a href="#cb54-6"></a>           <span class="fu">starts_with</span>(<span class="st">"ST341"</span>),</span>
<span id="cb54-7"><a href="#cb54-7"></a>           <span class="fu">starts_with</span>(<span class="st">"PA185"</span>),</span>
<span id="cb54-8"><a href="#cb54-8"></a>           <span class="fu">starts_with</span>(<span class="st">"CREA"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb54-9"><a href="#cb54-9"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10"></a>  <span class="fu">group_by</span>(CNT) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CNT, </span>
<span id="cb54-12"><a href="#cb54-12"></a>               <span class="at">names_to =</span> <span class="st">"creativity"</span>,</span>
<span id="cb54-13"><a href="#cb54-13"></a>               <span class="at">values_to =</span> <span class="st">"present"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-14"><a href="#cb54-14"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(present)) <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15"></a>  <span class="fu">pull</span>(creativity) <span class="sc">%&gt;%</span> </span>
<span id="cb54-16"><a href="#cb54-16"></a>  <span class="fu">unique</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="cyprus-present-but-missing" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="cyprus-present-but-missing">
<span class="header-section-number">6.2</span> Cyprus present but missing</h2>
<p>Cyprus is still present in the levels of <code>CNT</code> even though PISA hasn’t recorded <a href="https://www.oecd.org/pisa/aboutpisa/cyprus-pisa.htm">data on Cyprus</a> since 2012. Other countries that didn’t participate in the 2022 round have been removed from the levels, e.g.&nbsp;China.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>countries <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(CNT) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb55-2"><a href="#cb55-2"></a>country_lvls <span class="ot">&lt;-</span> PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">pull</span>(CNT) <span class="sc">%&gt;%</span> <span class="fu">levels</span>()</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="fu">setdiff</span>(country_lvls, countries)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section><section id="great-britain-vs-the-united-kingdom" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="great-britain-vs-the-united-kingdom">
<span class="header-section-number">6.3</span> Great Britain vs the United Kingdom</h2>
<p>The <em>United Kingdom</em> is the country referred to when correctly combining the results of England, Scotland, Wales and Northern Ireland. However, the <em>regions</em> of the United Kingdom listed by the OECD are <em>“Great Britain:”</em> followed by England, Scotland, Wales and Northern Ireland. Northern Ireland isn’t part of <a href="https://en.wikipedia.org/wiki/Great_Britain">Great Britain</a>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>PISA_2022 <span class="sc">%&gt;%</span> <span class="fu">select</span>(CNT, REGION) <span class="sc">%&gt;%</span> </span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"Great Britain"</span>, REGION)) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  CNT            REGION                         
  &lt;fct&gt;          &lt;fct&gt;                          
1 United Kingdom Great Britain: Wales           
2 United Kingdom Great Britain: Northern Ireland
3 United Kingdom Great Britain: England         
4 United Kingdom Great Britain: Scotland        </code></pre>
</div>
</div>
</section><section id="how-to-spell-ukrainian" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="how-to-spell-ukrainian">
<span class="header-section-number">6.4</span> How to spell “Ukrainian”</h2>
<p>PISA records the language of the test sat by students in Ukraine <code>LANGTEST_QQQ</code> as “Ukranian” and the language they speak at home <code>LANGN</code> as “Ukrainian”</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>PISA_2022 <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">filter</span>(CNT <span class="sc">==</span> <span class="st">"Ukrainian regions (18 of 27)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="fu">group_by</span>(LANGTEST_QQQ, LANGN) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>  <span class="fu">count</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   LANGTEST_QQQ, LANGN [11]
   LANGTEST_QQQ LANGN                            n
   &lt;fct&gt;        &lt;fct&gt;                        &lt;int&gt;
 1 Russian      Russian                         16
 2 Russian      Ukrainian                        4
 3 Russian      Another language (UKR)           1
 4 Russian      Missing                          1
 5 Ukranian     Romani                           9
 6 Ukranian     Russian                        421
 7 Ukranian     Ukrainian                     3133
 8 Ukranian     Crimean Tatar Language (UKR)     9
 9 Ukranian     Another language (UKR)          56
10 Ukranian     Missing                        113
11 &lt;NA&gt;         Missing                        113</code></pre>
</div>
</div>
</section></section><section id="interesting-papers-and-reading-on-pisa" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Interesting papers and reading on PISA</h1>
<p><strong>There are a number of useful OECD reports including</strong>:</p>
<ul>
<li>PISA Data Analysis Manual: SPSS second edition <span class="citation" data-cites="pisadat2009manual">OECD (<a href="#ref-pisadat2009manual" role="doc-biblioref">2009b</a>)</span>;</li>
<li>The PISA 2018 technical report <span class="citation" data-cites="pisa2019technical">OECD (<a href="#ref-pisa2019technical" role="doc-biblioref">2019b</a>)</span>
</li>
<li>PISA 2018 results <span class="citation" data-cites="pisa2018results">OECD (<a href="#ref-pisa2018results" role="doc-biblioref">2019a</a>)</span>
</li>
<li><a href="https://www.oecd.org/pisa/pisaproducts/PISA-2021-Adjusted-Design.pdf">PISA Adjusted 2021 design</a></li>
<li><a href="https://pisa-framework.oecd.org/science-2025/assets/docs/PISA_2025_Science_Framework.pdf">The PISA 2025 draft framework</a></li>
</ul>
<p><strong>John Jerrim and colleagues</strong> have written a number of papers which provide commentary on PISA analysis</p>
<ul>
<li>PISA 2012: how do results for the paper and computer tests compare? <span class="citation" data-cites="jerrim2016pisa">Jerrim (<a href="#ref-jerrim2016pisa" role="doc-biblioref">2016</a>)</span>
</li>
<li>To weight or not to weight?: The case of PISA data <span class="citation" data-cites="jerrim2017weight">Jerrim et al. (<a href="#ref-jerrim2017weight" role="doc-biblioref">2017</a>)</span>
</li>
<li>PISA 2015: how big is the ‘mode effect’ and what has been done about it? <span class="citation" data-cites="jerrim2018pisa">Jerrim et al. (<a href="#ref-jerrim2018pisa" role="doc-biblioref">2018</a>)</span>
</li>
<li>PISA 2018 in England, Northern Ireland, Scotland and Wales: Is the data really representative of all four corners of the UK? <span class="citation" data-cites="jerrim2021pisa">Jerrim (<a href="#ref-jerrim2021pisa" role="doc-biblioref">2021</a>)</span>
</li>
<li>Is Canada really an education superpower? The impact of non-participation on results from PISA 2015 <span class="citation" data-cites="anders2021canada">Anders et al. (<a href="#ref-anders2021canada" role="doc-biblioref">2021</a>)</span>
</li>
<li>Has Peak PISA passed? An investigation of interest in International Large-Scale Assessments across countries and over time <span class="citation" data-cites="jerrim2023peak">Jerrim (<a href="#ref-jerrim2023peak" role="doc-biblioref">2023</a>)</span>
</li>
<li>Conditioning: how background variables can influence PISA scores <span class="citation" data-cites="zieger2022conditioning">Zieger et al. (<a href="#ref-zieger2022conditioning" role="doc-biblioref">2022</a>)</span>
</li>
</ul>
<p><strong>Other PISA Papers of Interest</strong></p>
<!-- -->
<ul>
<li>PISA according to PISA: Does PISA keep what it promises? <span class="citation" data-cites="cordingley2008research">Cordingley (<a href="#ref-cordingley2008research" role="doc-biblioref">2008</a>)</span>
</li>
<li>The policy impact of PISA: An exploration of the normative effects of international benchmarking in school system performance <span class="citation" data-cites="breakspear2012policy">Breakspear (<a href="#ref-breakspear2012policy" role="doc-biblioref">2012</a>)</span>
</li>
<li>A call for a more measured approach to reporting and interpreting PISA results <span class="citation" data-cites="rutkowski2016call">Rutkowski and Rutkowski (<a href="#ref-rutkowski2016call" role="doc-biblioref">2016</a>)</span>
</li>
<li>PISA data: Raising concerns with its use in policy settings <span class="citation" data-cites="gillis2016pisa">Gillis, Polesel, and Wu (<a href="#ref-gillis2016pisa" role="doc-biblioref">2016</a>)</span>
</li>
<li>Differential item functioning in PISA due to mode effects <span class="citation" data-cites="feskens2019differential">Feskens, Fox, and Zwitser (<a href="#ref-feskens2019differential" role="doc-biblioref">2019</a>)</span>
</li>
<li>The measure of socio-economic status in PISA: A review and some suggested improvements <span class="citation" data-cites="avvisati2020measure">Avvisati (<a href="#ref-avvisati2020measure" role="doc-biblioref">2020</a>)</span>
</li>
<li>Conditioning: How background variables can influence PISA scores <span class="citation" data-cites="zieger2022conditioning">Zieger et al. (<a href="#ref-zieger2022conditioning" role="doc-biblioref">2022</a>)</span>
</li>
<li>A critique of how socio-economic status is measured in PISA <span class="citation" data-cites="avvisati2020measure">Avvisati (<a href="#ref-avvisati2020measure" role="doc-biblioref">2020</a>)</span>
</li>
</ul></section><section id="copyright" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Copyright</h1>
<blockquote class="blockquote">
<p>All PISA products are published under the <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/igo/">Creative Commons Attribution - NonCommercial - ShareAlike 3.0 IGO</a> (CC BY-NC-SA 3.0 IGO)</p>
</blockquote>
<p>This includes the <code>.feather</code> and <code>.parquet</code> formatted data sets linked in this book.</p>



</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-anders2021canada" class="csl-entry" role="listitem">
Anders, Jake, Silvan Has, John Jerrim, Nikki Shure, and Laura Zieger. 2021. <span>“Is Canada Really an Education Superpower? The Impact of Non-Participation on Results from PISA 2015.”</span> <em>Educational Assessment, Evaluation and Accountability</em> 33: 229–49.
</div>
<div id="ref-avvisati2020measure" class="csl-entry" role="listitem">
Avvisati, Francesco. 2020. <span>“The Measure of Socio-Economic Status in PISA: A Review and Some Suggested Improvements.”</span> <em>Large-Scale Assessments in Education</em> 8 (1): 1–37.
</div>
<div id="ref-breakspear2012policy" class="csl-entry" role="listitem">
Breakspear, Simon. 2012. <span>“The Policy Impact of PISA: An Exploration of the Normative Effects of International Benchmarking in School System Performance.”</span>
</div>
<div id="ref-cordingley2008research" class="csl-entry" role="listitem">
Cordingley, P. 2008. <span>“Research and Evidence-Informed Practice: Focusing on Practice and Practitioners.”</span> <em>Cambridge Journal of Education</em> 38 (1): 37–52. <a href="https://doi.org/10.1080/03057640801889964">https://doi.org/10.1080/03057640801889964</a>.
</div>
<div id="ref-du2019science" class="csl-entry" role="listitem">
Du, Xin, and Billy Wong. 2019. <span>“Science Career Aspiration and Science Capital in China and <span>UK</span>: A Comparative Study Using PISA Data.”</span> <em>International Journal of Science Education</em> 41 (15): 2136–55.
</div>
<div id="ref-feskens2019differential" class="csl-entry" role="listitem">
Feskens, Remco, Jean-Paul Fox, and Robert Zwitser. 2019. <span>“Differential Item Functioning in PISA Due to Mode Effects.”</span> <em>Theoretical and Practical Advances in Computer-Based Educational Measurement</em>, 231–47.
</div>
<div id="ref-gillis2016pisa" class="csl-entry" role="listitem">
Gillis, Shelley, John Polesel, and Margaret Wu. 2016. <span>“PISA Data: Raising Concerns with Its Use in Policy Settings.”</span> <em>The Australian Educational Researcher</em> 43: 131–46.
</div>
<div id="ref-jerrim2016pisa" class="csl-entry" role="listitem">
Jerrim, John. 2016. <span>“PISA 2012: How Do Results for the Paper and Computer Tests Compare?”</span> <em>Assessment in Education: Principles, Policy &amp; Practice</em> 23 (4): 495–518.
</div>
<div id="ref-jerrim2021pisa" class="csl-entry" role="listitem">
———. 2021. <span>“PISA 2018 in England, Northern Ireland, Scotland and Wales: Is the Data Really Representative of All Four Corners of the UK?”</span> <em>Review of Education</em> 9 (3): e3270.
</div>
<div id="ref-jerrim2023peak" class="csl-entry" role="listitem">
———. 2023. <span>“Has Peak PISA Passed? An Investigation of Interest in International Large-Scale Assessments Across Countries and over Time.”</span> <em>European Educational Research Journal</em>, 14749041231151793.
</div>
<div id="ref-jerrim2017weight" class="csl-entry" role="listitem">
Jerrim, John, Luis Alejandro Lopez-Agudo, Oscar D Marcenaro-Gutierrez, and Nikki Shure. 2017. <span>“To Weight or Not to Weight?: The Case of PISA Data.”</span> In <em>Proceedings of the XXVI Meeting of the Economics of Education Association, Murcia, Spain</em>, 29–30.
</div>
<div id="ref-jerrim2018pisa" class="csl-entry" role="listitem">
Jerrim, John, John Micklewright, Jorg-Henrik Heine, Christine Salzer, and Caroline McKeown. 2018. <span>“PISA 2015: How Big Is the ‘Mode Effect’and What Has Been Done about It?”</span> <em>Oxford Review of Education</em> 44 (4): 476–93.
</div>
<div id="ref-monseur2009pisa" class="csl-entry" role="listitem">
Monseur, Christian et al. 2009. <span>“PISA Data Analysis Manual: <span>SPSS</span> Second Edition.”</span> <a href="https://www.oecd-ilibrary.org/docserver/9789264056275-en.pdf?expires=1672909117&amp;id=id&amp;accname=guest&amp;checksum=3AD95B021546E6CB9B93D8895B011056">https://www.oecd-ilibrary.org/docserver/9789264056275-en.pdf?expires=1672909117&amp;id=id&amp;accname=guest&amp;checksum=3AD95B021546E6CB9B93D8895B011056</a>.
</div>
<div id="ref-OECD2009tech" class="csl-entry" role="listitem">
OECD. 2009a. <em>PISA 2006 Technical Report</em>. OECD.
</div>
<div id="ref-pisadat2009manual" class="csl-entry" role="listitem">
OECD. 2009b. <span>“<span>PISA Data Analysis Manual: SPSS, Second Edition</span>.”</span> <em><span>PISA</span></em>, March. <a href="https://doi.org/10.1787/9789264056275-en">https://doi.org/10.1787/9789264056275-en</a>.
</div>
<div id="ref-OECD2014technical" class="csl-entry" role="listitem">
———. 2014. <span>“PISA 2012 Technical Report.”</span> OECD, Paris. <a href="https://www.oecd.org/pisa/pisaproducts/PISA-2012-technical-report-final.pdf">https://www.oecd.org/pisa/pisaproducts/PISA-2012-technical-report-final.pdf</a>.
</div>
<div id="ref-OECD2018technical" class="csl-entry" role="listitem">
———. 2018. <span>“Technical Report.”</span> OECD, Paris. <a href="https://www.oecd.org/pisa/data/pisa2018technicalreport/PISA2018-TecReport-Ch-01-Programme-for-International-Student-Assessment-An-Overview.pdf">https://www.oecd.org/pisa/data/pisa2018technicalreport/PISA2018-TecReport-Ch-01-Programme-for-International-Student-Assessment-An-Overview.pdf</a>.
</div>
<div id="ref-pisa2018results" class="csl-entry" role="listitem">
———. 2019a. <span>“<span>PISA 2018 Results (Volume I)</span>.”</span> <em><span>PISA</span></em>, December. <a href="https://doi.org/10.1787/a9b5930a-en">https://doi.org/10.1787/a9b5930a-en</a>.
</div>
<div id="ref-pisa2019technical" class="csl-entry" role="listitem">
———. 2019b. <span>“<span class="nocase">PISA 2018 technical background</span>.”</span> <em><span>PISA</span></em>, December. <a href="https://doi.org/10.1787/89178eb6-en">https://doi.org/10.1787/89178eb6-en</a>.
</div>
<div id="ref-pulkkinen2022correspondence" class="csl-entry" role="listitem">
Pulkkinen, Jonna, and Juhani Rautopuro. 2022. <span>“The Correspondence Between PISA Performance and School Achievement in Finland.”</span> <em>International Journal of Educational Research</em> 114: 102000.
</div>
<div id="ref-rijmen2011hierarchical" class="csl-entry" role="listitem">
Rijmen, Frank. 2011. <span>“Hierarchical Factor Item Response Theory Models for PIRLS: Capturing Clustering Effects at Multiple Levels.”</span> <em>IERI Monograph Series: Issues and Methodologies in Large-Scale Assessments</em> 4: 59–74.
</div>
<div id="ref-rubin1987multiple" class="csl-entry" role="listitem">
Rubin, D. B. 1987. <em>Multiple Imputation for Nonresponse in Surveys</em>. John Wiley &amp; Sons.
</div>
<div id="ref-rutkowski2016call" class="csl-entry" role="listitem">
Rutkowski, Leslie, and David Rutkowski. 2016. <span>“A Call for a More Measured Approach to Reporting and Interpreting PISA Results.”</span> <em>Educational Researcher</em> 45 (4): 252–57.
</div>
<div id="ref-zieger2022conditioning" class="csl-entry" role="listitem">
Zieger, Laura Raffaella, John Jerrim, Jake Anders, and Nikki Shure. 2022. <span>“Conditioning: How Background Variables Can Influence PISA Scores.”</span> <em>Assessment in Education: Principles, Policy &amp; Practice</em> 29 (6): 632–52.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->



</body></html>